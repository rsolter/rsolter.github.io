<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Daily Forecasting of Capital Bikeshare usage with Facebook’s prophet -</title>
<meta name="description" content="An exploration of Facebook’s prophet package for estimating daily ridership of the DC Capital BikeShare program. ">


  <meta name="author" content="Ravi Solter">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="">
<meta property="og:title" content="Daily Forecasting of Capital Bikeshare usage with Facebook’s prophet">
<meta property="og:url" content="http://localhost:4000/r/forecasting/Daily_Bike_Forecast/">


  <meta property="og:description" content="An exploration of Facebook’s prophet package for estimating daily ridership of the DC Capital BikeShare program. ">







  <meta property="article:published_time" content="2019-12-20T00:00:00-05:00">





  

  


<link rel="canonical" href="http://localhost:4000/r/forecasting/Daily_Bike_Forecast/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Ravi Solter",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title=" Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/index.html"><img src="/assets/images/Navigation Images/house.png"> Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/"><img src="/assets/images/Navigation Images/posts.png"> Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/"><img src="/assets/images/Navigation Images/projects.png"> Projects</a>
            </li><li class="masthead__menu-item">
              <a href="/certs/"><img src="/assets/images/Navigation Images/certificate.png"> Certifications</a>
            </li><li class="masthead__menu-item">
              <a href="/about/"><img src="/assets/images/Navigation Images/user.png"> About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/va_photo-01.jpeg" alt="Ravi Solter" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Ravi Solter</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Data scientist at Marriott International, working in R and Python</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Washington DC</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/rsolter" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/rsolter/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      
        <li>
          <a href="mailto:ravisolter@gmail.com">
            <meta itemprop="email" content="ravisolter@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Daily Forecasting of Capital Bikeshare usage with Facebook’s prophet">
    <meta itemprop="description" content="An exploration of Facebook’s prophet package for estimating daily ridership of the DC Capital BikeShare program.">
    <meta itemprop="datePublished" content="2019-12-20T00:00:00-05:00">
    

    <div class="page__inner-wrap">
      
        <header>
          

        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-calendar-day"></i> Content</h4></header>
              <ul class="toc__menu">
  <li><a href="#predicting-daily-dc-bike-share-ridership-with-prophet">Predicting Daily DC Bike Share Ridership with prophet</a></li>
  <li><a href="#visual-exploration-of-daily-ridership-data">Visual Exploration of Daily Ridership Data</a>
    <ul>
      <li><a href="#removing-outliers">Removing Outliers</a></li>
    </ul>
  </li>
  <li><a href="#prophet-models">Prophet Models</a>
    <ul>
      <li><a href="#base-model">Base Model</a></li>
      <li><a href="#logistic-growth-model--carrying-capacity">Logistic Growth Model + Carrying Capacity</a></li>
      <li><a href="#model-with-logistic-transformation">Model with Logistic Transformation</a></li>
      <li><a href="#model-with-precipitation-regressor">Model with precipitation Regressor</a></li>
    </ul>
  </li>
  <li><a href="#conclusion-and-next-steps">Conclusion and Next Steps</a></li>
</ul>

            </nav>
          </aside>
        
        <h2 id="predicting-daily-dc-bike-share-ridership-with-prophet">Predicting Daily DC Bike Share Ridership with <strong>prophet</strong></h2>

<p>The
<a href="https://facebook.github.io/prophet/docs/quick_start.html#r-api">prophet</a>
package was created by Facebook in 2017 and provides a procedure for
forecasting time series data. It’s a great package that’s meant to help
produce reasonable forecasts with messy data without much manual effort.
Prophet can handle, yearly, weekly, and daily seasonality, miultiple
regressors, missing data, and can account for holidays or other dates
that have a profound effect on the time series. It’s also very quick,
allowing the user to iterate between many different approaches. The full
white paper is available <a href="https://peerj.com/preprints/3190/">here</a></p>

<p>I’ve used prophet for goal-setting in a previous role, but in this post
will apply it to the DC Capital BikeShare daily ridership. This post is
an extension of the <a href="https://rsolter.github.io/r/forecasting/Monthly_Bike_Forecast/">Forecasting Monthly Usage of Capital
Bikeshare</a>;
its dataset is from the same source, just not aggregated to the monthly
level.</p>

<p>To try and improve the accuracy of the ridership forecasts, daily
precipitation data from NOAA will be included. The precipitation data
was collected from the Reagan National Airport weather station and
measures precipitation in tenths of a millimeter.</p>

<hr />

<h2 id="visual-exploration-of-daily-ridership-data">Visual Exploration of Daily Ridership Data</h2>

<p>A few takeaways:</p>

<ul>
  <li>
    <p>The average number of trips taken in a given day is just under
7,500.</p>
  </li>
  <li>
    <p>Unsurprisingly, the series exhibits clear seasonality, with more
trips taking place during the summer months and fewer during the
winter. From this plot, it’s unclear if a weekly seasonality exists.</p>
  </li>
  <li>
    <p>There are also a number of outliers apparent in the data. Most of
these outliers are registering below the curve, and could possibly
be due to bad weather on those particular days. There also appear to
be a few positive outliers in the first quarter of the year and
could relate to a seasonal event such as the arrival of the cherry
blossoms.</p>
  </li>
  <li>
    <p>Given that the size of the seasonal fluctuations grow over time, a
multiplicative model may be best for modeling this series.</p>
  </li>
  <li>
    <p>Similarly, over time the trend appears to grow less and less,
indicating a model incorporating a logistic trend may be most
appropriate. Ostensibly, this growth is down to the
<a href="https://en.wikipedia.org/wiki/Capital_Bikeshare#Expansion">expansion</a>
in the number of bike stations and bikes over the last ~10 years.</p>
  </li>
</ul>

<!-- -->

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
##       1    4378    7296    7499   10804   19113
</code></pre></div></div>

<p><img src="/rblogging/2019/12/20/exploratory%20viz-1.png" alt="" /><img src="/rblogging/2019/12/20/exploratory%20viz-2.png" alt="" /></p>

<hr />

<h3 id="removing-outliers">Removing Outliers</h3>

<p>Since there appear to be multiple outliers in the dataset and the
prophet package can handle missing data points, we’ll remove some
outliers before proceeding to modeling the data.</p>

<p><em>Identifying and processing outliers</em></p>

<p>One way to identify outliers is to use <a href="https://anomaly.io/anomaly-detection-moving-median-decomposition/">moving-median
decomposition</a>.
In the case below, a two-week-long running median trend is subtracted
from the original series. Next, observations which fall outside of 4
standard deviations of that running median trend are isolated and
removed from the series for future modeling.</p>

<p><img src="/rblogging/2019/12/20/Handing%20Outliers%20in%20overall%20dataset-1.png" alt="" /><img src="/rblogging/2019/12/20/Handing%20Outliers%20in%20overall%20dataset-2.png" alt="" /></p>

<hr />

<h2 id="prophet-models">Prophet Models</h2>

<p>To test the model, the daily observations of bike rides and daily
precipitation are split into training sets (2010-05-15 to 2016-08-31)
and test splits (2016-09-01 to 2018-09-17). Effectively, 25% of the data
is being set aside for testing.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Change column names for propet package</span><span class="w">
</span><span class="n">prophet_btrips</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bike_trips_clean</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">prophet_btrips</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"ds"</span><span class="p">,</span><span class="s2">"y"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Paritioning</span><span class="w">
</span><span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prophet_btrips</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&lt;</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 2173 records</span><span class="w">
</span><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prophet_btrips</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&gt;=</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 747 records</span><span class="w">

</span><span class="n">reg_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">percip</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&lt;</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 2178 records</span><span class="w">
</span><span class="n">reg_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">percip</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&gt;=</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 747 records</span><span class="w">
</span></code></pre></div></div>

<h3 id="base-model">Base Model</h3>

<p>The first model is set to account for daily, weekly, and yearly
seasonality.</p>

<p>Ultimately, the MAPE is close to 31%. From both the plot of the forecast
as well as the residual distribution, we can see that the current model
generally underestimates daily ridership.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># https://facebook.github.io/prophet/docs/quick_start.html#r-api</span><span class="w">

</span><span class="c1">## Prophet Forecast 1</span><span class="w">

  </span><span class="c1"># Training</span><span class="w">
  </span><span class="n">prophetFit1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prophet</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="w">
                         </span><span class="n">yearly.seasonality</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w">
                         </span><span class="n">weekly.seasonality</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w">
                         </span><span class="n">daily.seasonality</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w">

  </span><span class="c1"># Creating dataframe for future forecast, will only have date values</span><span class="w">
  </span><span class="n">future</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">prophetFit1</span><span class="p">,</span><span class="w"> </span><span class="n">periods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">test</span><span class="p">),</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'day'</span><span class="p">)</span><span class="w">

  </span><span class="c1"># Predicting - resulting 'prophetForecast1' dataframe contains columns for predictions, trend data, and uncertainty intervals</span><span class="w">
  </span><span class="n">prophetForecast1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">prophetFit1</span><span class="p">,</span><span class="w"> </span><span class="n">future</span><span class="p">)</span><span class="w">

  </span><span class="c1"># Visualizing ts components - trend, weekly and yearly seasonalities</span><span class="w">
  </span><span class="n">prophet_plot_components</span><span class="p">(</span><span class="n">prophetFit1</span><span class="p">,</span><span class="w"> </span><span class="n">prophetForecast1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/rblogging/2019/12/20/Prophet%20Forecast%201-1.png" alt="" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="c1"># Visualize forecast</span><span class="w">
  </span><span class="c1">#plot(prophetFit1, prophetForecast1,ylabel = "Daily Rides",xlabel = "Date")</span><span class="w">

  </span><span class="c1"># Plot</span><span class="w">
  </span><span class="n">p1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">
  </span><span class="n">p1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prophetFit1</span><span class="o">$</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w">
  </span><span class="n">p1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prophetForecast1</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#0072B2"</span><span class="p">)</span><span class="w">
  </span><span class="n">p1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_ribbon</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prophetForecast1</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat_lower</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat_upper</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#0072B2"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.15</span><span class="p">)</span><span class="w">
  </span><span class="n">p1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'#4daf4a'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">scale_x_date</span><span class="p">(</span><span class="n">date_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"%Y"</span><span class="p">)</span><span class="w">
  </span><span class="n">p1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Propet Base Model"</span><span class="p">,</span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Test data in green"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Date"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Daily Rides"</span><span class="p">)</span><span class="w">

  </span><span class="n">p1</span><span class="w">
</span></code></pre></div></div>

<p><img src="/rblogging/2019/12/20/Prophet%20Forecast%201-2.png" alt="" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="c1"># Dynamic Plot of forecast</span><span class="w">
  </span><span class="c1"># dyplot.prophet(prophetFit1, prophetForecast1)  </span><span class="w">



</span><span class="c1">## Prophet Foreceast 1 - Evaluation</span><span class="w">


  </span><span class="c1"># Calculating Fit</span><span class="w">
  </span><span class="n">Fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">y_hat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tail</span><span class="p">(</span><span class="n">prophetForecast1</span><span class="o">$</span><span class="n">yhat</span><span class="p">,</span><span class="n">nrow</span><span class="p">(</span><span class="n">test</span><span class="p">))</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">resid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Fit</span><span class="o">$</span><span class="n">y</span><span class="o">-</span><span class="n">Fit</span><span class="o">$</span><span class="n">y_hat</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">resid_perc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">Fit</span><span class="o">$</span><span class="n">resid</span><span class="o">/</span><span class="n">Fit</span><span class="o">$</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">abs_resid_perc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">Fit</span><span class="o">$</span><span class="n">resid_perc</span><span class="p">)</span><span class="w">

  </span><span class="n">error_summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="n">summary</span><span class="p">(</span><span class="n">Fit</span><span class="o">$</span><span class="n">abs_resid_perc</span><span class="p">)</span><span class="w">


  </span><span class="c1"># Results</span><span class="w">
  </span><span class="n">error_summary</span><span class="w"> </span><span class="c1"># A summary of the errors as percentages</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
##   0.0069   8.0666  15.7430  31.2611  25.1704 621.1372
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">Fit</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">resid_perc</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Prophet Model 1 : Distribution of Residuals (%)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Residual Percentage"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><img src="/rblogging/2019/12/20/Prophet%20Forecast%201-3.png" alt="" /></p>

<hr />

<h3 id="logistic-growth-model--carrying-capacity">Logistic Growth Model + Carrying Capacity</h3>

<p>Given that the overall trend appears to be leveling off, we’ll try a
second modeling approach with a logistic growth specified and a carrying
capacity. The <em>carry capacity</em> refers to the maxium possible value for
the series. In this case, we’ll set it at 19,113 which was the maximum
value of rides in the original dataset.</p>

<p>Unforuntately, taking both of these steps doesn’t seem to have a
material difference on the MAPE (32%) or the overall</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="c1"># Training</span><span class="w">

  </span><span class="n">train</span><span class="o">$</span><span class="n">cap</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">19113</span><span class="w">  

  </span><span class="n">prophetFit2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prophet</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="w">
                         </span><span class="n">yearly.seasonality</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w">
                         </span><span class="n">weekly.seasonality</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w">
                         </span><span class="n">daily.seasonality</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">,</span><span class="w">
                         </span><span class="n">growth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"logistic"</span><span class="p">)</span><span class="w">

  </span><span class="c1"># Creating dataframe for future forecast</span><span class="w">
  </span><span class="n">future</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">prophetFit2</span><span class="p">,</span><span class="w"> </span><span class="n">periods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">test</span><span class="p">),</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'day'</span><span class="p">)</span><span class="w">
  </span><span class="n">future</span><span class="o">$</span><span class="n">cap</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">19113</span><span class="w">


  </span><span class="c1"># Predicting</span><span class="w">
  </span><span class="n">prophetForecast2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">prophetFit2</span><span class="p">,</span><span class="w"> </span><span class="n">future</span><span class="p">)</span><span class="w">

  </span><span class="c1"># The resulting prophetForecast1 dataframe contains columns for predictions, trend data, and uncertainty intervals</span><span class="w">

  </span><span class="c1"># Visualizing ts components - trend, weekly and yearly seasonalities</span><span class="w">
  </span><span class="n">prophet_plot_components</span><span class="p">(</span><span class="n">prophetFit2</span><span class="p">,</span><span class="w"> </span><span class="n">prophetForecast2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/rblogging/2019/12/20/Prophet%20Forecast%202%20Log%20Growth%20+%20CC-1.png" alt="" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="c1"># Visualize forecast</span><span class="w">
  </span><span class="c1"># Plot</span><span class="w">
  </span><span class="n">p2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">
  </span><span class="n">p2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prophetFit2</span><span class="o">$</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w">
  </span><span class="n">p2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prophetForecast2</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#0072B2"</span><span class="p">)</span><span class="w">
  </span><span class="n">p2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_ribbon</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prophetForecast2</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat_lower</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat_upper</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#0072B2"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.15</span><span class="p">)</span><span class="w">
  </span><span class="n">p2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'#4daf4a'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">scale_x_date</span><span class="p">(</span><span class="n">date_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"%Y"</span><span class="p">)</span><span class="w">
  </span><span class="n">p2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Propet Model: Logistic Growth + Carrying Capacity"</span><span class="p">,</span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Test data in green"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Date"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Daily Rides"</span><span class="p">)</span><span class="w">

  </span><span class="n">p2</span><span class="w">
</span></code></pre></div></div>

<p><img src="/rblogging/2019/12/20/Prophet%20Forecast%202%20Log%20Growth%20+%20CC-2.png" alt="" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="c1"># Dynamic Plot of forecast</span><span class="w">
  </span><span class="c1">#dyplot.prophet(prophetFit1, prophetForecast1)  </span><span class="w">


</span><span class="c1"># Evaluation of the second prediction:</span><span class="w">

  </span><span class="c1"># Calculating Fit</span><span class="w">
  </span><span class="n">Fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">y_hat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tail</span><span class="p">(</span><span class="n">prophetForecast2</span><span class="o">$</span><span class="n">yhat</span><span class="p">,</span><span class="n">nrow</span><span class="p">(</span><span class="n">test</span><span class="p">))</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">resid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Fit</span><span class="o">$</span><span class="n">y</span><span class="o">-</span><span class="n">Fit</span><span class="o">$</span><span class="n">y_hat</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">resid_perc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">Fit</span><span class="o">$</span><span class="n">resid</span><span class="o">/</span><span class="n">Fit</span><span class="o">$</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">abs_resid_perc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">Fit</span><span class="o">$</span><span class="n">resid_perc</span><span class="p">)</span><span class="w">

  </span><span class="n">error_summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="n">summary</span><span class="p">(</span><span class="n">Fit</span><span class="o">$</span><span class="n">abs_resid_perc</span><span class="p">)</span><span class="w">


  </span><span class="c1"># Results</span><span class="w">
  </span><span class="n">error_summary</span><span class="w"> </span><span class="c1"># A summary of the errors as percentages</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
##   0.0174   7.5454  14.9604  32.1028  26.0863 648.6879
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">Fit</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">resid_perc</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Prophet Model 2 : Distribution of Residuals (%)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Residual Percentage"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><img src="/rblogging/2019/12/20/Prophet%20Forecast%202%20Log%20Growth%20+%20CC-3.png" alt="" /></p>

<h3 id="model-with-logistic-transformation">Model with Logistic Transformation</h3>

<p>Another step we can take is transforming the data with logarithmic
transformation. This is done when the time series shows
heteroskedasticity, or a non-constant variance. This is evident in the
way the size of the seasonal swings in ridership grow over time.</p>

<p>Transforming the data back to compare our predictions to the test set
reports a MAPE of 26%, a clear improvement!</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 3rd Prophet prediction with Log transformation</span><span class="w">



</span><span class="c1"># Paritioning</span><span class="w">
</span><span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prophet_btrips</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&lt;</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 2173 records</span><span class="w">
</span><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prophet_btrips</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&gt;=</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 747 records</span><span class="w">

</span><span class="n">reg_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">percip</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&lt;</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 2178 records</span><span class="w">
</span><span class="n">reg_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">percip</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&gt;=</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 747 records</span><span class="w">


  </span><span class="c1">## The log transform results in slightly lower MAPE rate</span><span class="w">

  </span><span class="c1"># Transform</span><span class="w">
  </span><span class="n">log_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">train</span><span class="w">
  </span><span class="n">log_train</span><span class="o">$</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">log_train</span><span class="o">$</span><span class="n">y</span><span class="p">)</span><span class="w">


  </span><span class="c1"># Trainging</span><span class="w">
  </span><span class="n">m_log</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prophet</span><span class="p">(</span><span class="n">log_train</span><span class="p">,</span><span class="w">
                   </span><span class="n">yearly.seasonality</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w">
                         </span><span class="n">weekly.seasonality</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w">
                         </span><span class="n">daily.seasonality</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">F</span><span class="p">)</span><span class="w">

  </span><span class="c1"># Creating dataframe for log forecast</span><span class="w">
  </span><span class="n">future_log</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">m_log</span><span class="p">,</span><span class="w"> </span><span class="n">periods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">test</span><span class="p">),</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'day'</span><span class="p">)</span><span class="w">

  </span><span class="c1"># Predicting</span><span class="w">
  </span><span class="n">forecast_log</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">m_log</span><span class="p">,</span><span class="w"> </span><span class="n">future_log</span><span class="p">)</span><span class="w">

  </span><span class="c1"># Visualize forecast</span><span class="w">
  </span><span class="c1">#plot(m_log, forecast_log)</span><span class="w">

  </span><span class="c1"># Plot</span><span class="w">
  </span><span class="n">p3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">
  </span><span class="n">p3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_log</span><span class="o">$</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w">
  </span><span class="n">p3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">forecast_log</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#0072B2"</span><span class="p">)</span><span class="w">
  </span><span class="n">p3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_ribbon</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">forecast_log</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat_lower</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat_upper</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#0072B2"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.15</span><span class="p">)</span><span class="w">
  </span><span class="c1">#p3 &lt;- p3 + geom_point(data = test, aes(x = ds, y = y), size = 0.5, color = '#4daf4a') + scale_x_date(date_labels = "%Y")</span><span class="w">
  </span><span class="n">p3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Propet Model: Log Transform"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Date"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Log Transform of Daily Rides"</span><span class="p">)</span><span class="w">

  </span><span class="n">p3</span><span class="w">
</span></code></pre></div></div>

<p><img src="/rblogging/2019/12/20/Prophet%20Forecast%203%20-%20Log-1.png" alt="" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="c1"># Visualizing ts components - trend, weekly and yearly seasonalities</span><span class="w">
  </span><span class="n">prophet_plot_components</span><span class="p">(</span><span class="n">m_log</span><span class="p">,</span><span class="w"> </span><span class="n">forecast_log</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/rblogging/2019/12/20/Prophet%20Forecast%203%20-%20Log-2.png" alt="" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="c1"># Function for back transform of log</span><span class="w">
  </span><span class="n">log_back</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">y</span><span class="p">){</span><span class="w">
    </span><span class="n">e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w">
    </span><span class="nf">return</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">y</span><span class="p">)</span><span class="w">
  </span><span class="p">}</span><span class="w">


  </span><span class="c1"># Calculating Fit</span><span class="w">
  </span><span class="n">Log_Fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test</span><span class="w">
  </span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">y_hat_log</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tail</span><span class="p">(</span><span class="n">forecast_log</span><span class="o">$</span><span class="n">yhat</span><span class="p">,</span><span class="n">nrow</span><span class="p">(</span><span class="n">Log_Fit</span><span class="p">))</span><span class="w">
  </span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">y_hat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">log_back</span><span class="p">(</span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">y_hat_log</span><span class="p">)</span><span class="w">

  </span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">resid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">y</span><span class="o">-</span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">y_hat</span><span class="w">
  </span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">resid_perc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">resid</span><span class="o">/</span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="w">

  </span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">abs_resid_perc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">resid_perc</span><span class="p">)</span><span class="w">


  </span><span class="n">log_error_summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="n">summary</span><span class="p">(</span><span class="n">Log_Fit</span><span class="o">$</span><span class="n">abs_resid_perc</span><span class="p">)</span><span class="w">



    </span><span class="c1"># Results</span><span class="w">
  </span><span class="n">log_error_summary</span><span class="w"> </span><span class="c1"># A summary of the errors as percentages</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
##   0.0484   8.9831  16.4676  26.3528  27.5142 381.9659
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">Log_Fit</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">resid_perc</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Prophet Model 3 : Distribution of Residuals (%)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Residual Percentage"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><img src="/rblogging/2019/12/20/Prophet%20Forecast%203%20-%20Log-3.png" alt="" /></p>

<h3 id="model-with-precipitation-regressor">Model with precipitation Regressor</h3>

<p>In this attempt, we will add the daily precipitation data in as a
regressor. Technically, we would want to actually use predictions of
daily precipitation if we wanted to do an actual forecast, but this is
just an illustrative example.</p>

<p>Unfortunately, the addition of this data has not materially improved the
accuracy of our predictions in comparison to the base model.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Paritioning</span><span class="w">
</span><span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prophet_btrips</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&lt;</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 2173 records</span><span class="w">
</span><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prophet_btrips</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&gt;=</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 747 records</span><span class="w">

</span><span class="n">reg_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">percip</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&lt;</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 2178 records</span><span class="w">
</span><span class="n">reg_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">percip</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ds</span><span class="o">&gt;=</span><span class="s1">'2016-09-01'</span><span class="p">)</span><span class="w"> </span><span class="c1"># 747 records</span><span class="w">


</span><span class="n">reg_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">left_join</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="n">reg_train</span><span class="p">)</span><span class="w">

</span><span class="c1">## Prophet Forecast 4</span><span class="w">

  </span><span class="c1"># Training</span><span class="w">
  </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prophet</span><span class="p">()</span><span class="w">
  </span><span class="n">add_regressor</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">"percip"</span><span class="p">)</span><span class="w">

  </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fit.prophet</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">reg_train</span><span class="p">)</span><span class="w">

  </span><span class="n">future_m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">periods</span><span class="o">=</span><span class="n">nrow</span><span class="p">(</span><span class="n">test</span><span class="p">),</span><span class="n">freq</span><span class="o">=</span><span class="s2">"day"</span><span class="p">)</span><span class="w">

  </span><span class="n">future_m</span><span class="o">$</span><span class="n">ds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">future_m</span><span class="o">$</span><span class="n">ds</span><span class="p">)</span><span class="w">
  </span><span class="n">percip</span><span class="o">$</span><span class="n">ds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">percip</span><span class="o">$</span><span class="n">ds</span><span class="p">)</span><span class="w">

  </span><span class="n">future_ridership</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">left_join</span><span class="p">(</span><span class="n">future_m</span><span class="p">,</span><span class="n">percip</span><span class="p">)</span><span class="w">

  </span><span class="n">reg_forecast</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">future_ridership</span><span class="p">)</span><span class="w">

  </span><span class="c1">#plot(m,reg_forecast)</span><span class="w">

  </span><span class="n">p4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">
  </span><span class="n">p4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="o">$</span><span class="n">history</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w">
  </span><span class="n">p4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg_forecast</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#0072B2"</span><span class="p">)</span><span class="w">
  </span><span class="n">p4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_ribbon</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg_forecast</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">ds</span><span class="p">),</span><span class="w"> </span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat_lower</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat_upper</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#0072B2"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.15</span><span class="p">)</span><span class="w">
  </span><span class="n">p4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'#4daf4a'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">scale_x_date</span><span class="p">(</span><span class="n">date_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"%Y"</span><span class="p">)</span><span class="w">
  </span><span class="n">p4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Propet Model: Using precipitation as a Regressor"</span><span class="p">,</span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Test data in green"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Date"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Daily Rides"</span><span class="p">)</span><span class="w">

  </span><span class="n">p4</span><span class="w">
</span></code></pre></div></div>

<p><img src="/rblogging/2019/12/20/Prophet%20Forecast%204%20-%20Regression-1.png" alt="" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Prophet Foreceast 4 - Evaluation</span><span class="w">


  </span><span class="c1"># Calculating Fit</span><span class="w">
  </span><span class="n">Fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">y_hat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tail</span><span class="p">(</span><span class="n">reg_forecast</span><span class="o">$</span><span class="n">yhat</span><span class="p">,</span><span class="n">nrow</span><span class="p">(</span><span class="n">test</span><span class="p">))</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">resid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Fit</span><span class="o">$</span><span class="n">y</span><span class="o">-</span><span class="n">Fit</span><span class="o">$</span><span class="n">y_hat</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">resid_perc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">Fit</span><span class="o">$</span><span class="n">resid</span><span class="o">/</span><span class="n">Fit</span><span class="o">$</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="w">
  </span><span class="n">Fit</span><span class="o">$</span><span class="n">abs_resid_perc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">Fit</span><span class="o">$</span><span class="n">resid_perc</span><span class="p">)</span><span class="w">

  </span><span class="n">error_summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="n">summary</span><span class="p">(</span><span class="n">Fit</span><span class="o">$</span><span class="n">abs_resid_perc</span><span class="p">)</span><span class="w">


  </span><span class="c1"># Results</span><span class="w">
  </span><span class="n">error_summary</span><span class="w"> </span><span class="c1"># A summary of the errors as percentages</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
##   0.0069   8.0666  15.7430  31.2611  25.1704 621.1372
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">Fit</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">resid_perc</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Prophet Model 4 : Distribution of Residuals (%)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Residual Percentage"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><img src="/rblogging/2019/12/20/Prophet%20Forecast%204%20-%20Regression-2.png" alt="" /></p>

<h2 id="conclusion-and-next-steps">Conclusion and Next Steps</h2>

<p>Predicting daily ridership is inherently difficult. swings in the weather, holidays, Nationals games, protests, and events like the blooming of the cherry blossoms can all affect ridership on a day to day basis. It shouldn’t come as much of a surprise that the best model put forth was the one that transformed the data specifically to handle non-constant variability in the time series.</p>

<p>That said, there are still a number of steps that could be taken to potentially
improve the prediction:</p>

<ul>
  <li>
    <p>Iterate further, trying different combinations of the above approaches.</p>
  </li>
  <li>
    <p>Make use of prophet’s holiday feature which allows for certain dates
to be marked as influential in establishing change points in the
trend</p>
  </li>
  <li>
    <p>Engineer the precipitation data to a dummy variable based upon a
certain amount of precipitation being measured</p>
  </li>
  <li>
    <p>Add more regressors such as number of bike stations in use or daily
temperature</p>
  </li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#forecasting" class="page__taxonomy-item" rel="tag">forecasting</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#r" class="page__taxonomy-item" rel="tag">R</a>
    
    </span>
  </p>


      </footer>

      

    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Ravi Solter. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>











  </body>
</html>
