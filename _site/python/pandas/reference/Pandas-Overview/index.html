<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>pandas Overview -</title>
<meta name="description" content="A reference post containing an overview of the key functions of pandas. Based upon material covered in a Udemy course, this post reviews data manipulation and aggregation functions from pandas on the Pitchfork review dataset from Kaggle. ">


  <meta name="author" content="Ravi Solter">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="">
<meta property="og:title" content="pandas Overview">
<meta property="og:url" content="http://localhost:4000/python/pandas/reference/Pandas-Overview/">


  <meta property="og:description" content="A reference post containing an overview of the key functions of pandas. Based upon material covered in a Udemy course, this post reviews data manipulation and aggregation functions from pandas on the Pitchfork review dataset from Kaggle. ">







  <meta property="article:published_time" content="2020-05-12T00:00:00-04:00">





  

  


<link rel="canonical" href="http://localhost:4000/python/pandas/reference/Pandas-Overview/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Ravi Solter",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title=" Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/index.html"><img src="/assets/images/Navigation Images/house.png"> Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/"><img src="/assets/images/Navigation Images/posts.png"> Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/projects/"><img src="/assets/images/Navigation Images/projects.png"> Projects</a>
            </li><li class="masthead__menu-item">
              <a href="/certs/"><img src="/assets/images/Navigation Images/certificate.png"> Certifications</a>
            </li><li class="masthead__menu-item">
              <a href="/about/"><img src="/assets/images/Navigation Images/user.png"> About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/va_photo-01.jpeg" alt="Ravi Solter" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Ravi Solter</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Data scientist at Marriott International, working in R and Python</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Washington DC</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/rsolter" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/rsolter/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      
        <li>
          <a href="mailto:ravisolter@gmail.com">
            <meta itemprop="email" content="ravisolter@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="pandas Overview">
    <meta itemprop="description" content="A reference post containing an overview of the key functions of pandas. Based upon material covered in a Udemy course, this post reviews data manipulation and aggregation functions from pandas on the Pitchfork review dataset from Kaggle.">
    <meta itemprop="datePublished" content="2020-05-12T00:00:00-04:00">
    

    <div class="page__inner-wrap">
      
        <header>
          

        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Content</h4></header>
              <ul class="toc__menu">
  <li><a href="#pandas-overview">pandas Overview</a></li>
  <li><a href="#1-inspecting-a-dataframe">1. Inspecting a dataframe</a></li>
  <li><a href="#2-selecting-columns-or-rows-from-a-dataframe">2. Selecting columns or rows from a dataframe</a></li>
  <li><a href="#3-adding-or-deleting-columns-and-rows">3. Adding or Deleting Columns and Rows</a></li>
  <li><a href="#4-filtering">4. Filtering</a></li>
  <li><a href="#5-ranking--sorting">5. Ranking &amp; Sorting</a></li>
  <li><a href="#6-working-with-nas">6. Working with NAs</a></li>
  <li><a href="#7-unique-and-duplicate-values">7. Unique and Duplicate values</a></li>
  <li><a href="#8-working-with-indexes">8. Working with Indexes</a></li>
  <li><a href="#9-renaming-labels-and-columns">9. Renaming Labels and Columns</a></li>
  <li><a href="#10-sampling">10. Sampling</a></li>
  <li><a href="#11-grouping-and-agg">11. Grouping and Agg</a></li>
  <li><a href="#12-date-and-times">12. Date and Times</a></li>
  <li><a href="#13-text-functions">13. Text Functions</a></li>
  <li><a href="#14-merging-joining-and-concatenating">14. Merging, Joining, and Concatenating</a></li>
  <li><a href="#15-reshaping-dataframes">15. Reshaping dataframes</a></li>
</ul>

            </nav>
          </aside>
        
        <p><img src="/assets/images/pandas.jpg" alt="pandas" class="align-center" /></p>

<h2 id="pandas-overview">pandas Overview</h2>

<p>Making the move from R to python, I feel out of place without my familiar tidyverse of packages for data maniuplation and visualization. As such, I’ve been spending a lot of time learning <a href="https://pandas.pydata.org/">pandas</a>, the most popular data analysis and manipulation tool in python.</p>

<p>This post is meant to serve as an overview of pandas functionality as well as serve as a personal reference. To demonstrate pandas, I’ve chosen to use a Kaggle <a href="https://www.kaggle.com/nolanbconaway/pitchfork-data">dataset</a> that compiles over 18k music reviews from the Pitchfork website.</p>

<p>A copy of this .ipynb can be found on <a href="https://github.com/rsolter/Udemy-Courses/blob/master/Udemy%20-%20Data%20Analysis%20with%20Pandas%20and%20Python/Summary.ipynb">here</a> my git repository for the Udemy pandas course</p>

<p><strong>Some useful links:</strong></p>

<ul>
  <li>
    <p><a href="https://pandas.pydata.org/">Official Pandas Documentation</a></p>
  </li>
  <li>
    <p><a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/comparison/comparison_with_r.html?highlight=arrange">Comparison with R/R libraries</a></p>
  </li>
  <li>
    <p><a href="https://towardsdatascience.com/the-unreasonable-effectiveness-of-method-chaining-in-pandas-15c2109e3c69">On Method Chaining in pandas</a></p>
  </li>
</ul>

<p><strong>Importing data</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="n">dt</span>

<span class="c1">## Importing csv for summary of functions
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">p4k</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"p4kreviews.csv"</span><span class="p">,</span>
                  <span class="n">encoding</span><span class="o">=</span><span class="s">'latin1'</span><span class="p">,</span>
                  <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># no index set, can specify id column if it exists
</span>                  <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s">"date"</span><span class="p">])</span> <span class="c1"># pandas is very good at recognizing dates upon import
</span></code></pre></div></div>

<h2 id="1-inspecting-a-dataframe">1. Inspecting a dataframe</h2>

<p><em>key methods: .head(), .describe(), .info(), .shape, .dtypes, .columns(), .value_counts()</em></p>

<p>Below is a preview of the dataset which includes each album’s score on a 10 point scale, artist name, album name, genre, review date, and text of the review. The best column refers to whether or not the album was designated a ‘best new music’ label.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1">## shows first five rows
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1">## Provides a summary of quantitative columns, extra transpose() method chained along
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>best</th>
      <td>19555.0</td>
      <td>0.053183</td>
      <td>0.224405</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>score</th>
      <td>19555.0</td>
      <td>7.027446</td>
      <td>1.277544</td>
      <td>0.0</td>
      <td>6.5</td>
      <td>7.3</td>
      <td>7.8</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">info</span><span class="p">()</span> <span class="c1">## Provides data type and non-null counts for each column
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 19555 entries, 1 to 19555
Data columns (total 7 columns):
 #   Column  Non-Null Count  Dtype         
---  ------  --------------  -----         
 0   album   19550 non-null  object        
 1   artist  19555 non-null  object        
 2   best    19555 non-null  int64         
 3   date    19555 non-null  datetime64[ns]
 4   genre   19555 non-null  object        
 5   review  19554 non-null  object        
 6   score   19555 non-null  float64       
dtypes: datetime64[ns](1), float64(1), int64(1), object(4)
memory usage: 1.2+ MB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">columns</span> <span class="c1">## Returns a list with the column names
</span><span class="n">p4k</span><span class="o">.</span><span class="n">dtypes</span> <span class="c1">## Returns the data types for each column
</span><span class="n">p4k</span><span class="o">.</span><span class="n">shape</span> <span class="c1">## Returns a tuple with dimensions of a dataset
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(19555, 7)
</code></pre></div></div>

<h2 id="2-selecting-columns-or-rows-from-a-dataframe">2. Selecting columns or rows from a dataframe</h2>

<p><em>key methods: .loc(), .iloc(), .value_counts()</em></p>

<p><strong>Selecting columns</strong> by name is done by passing the column(s) quoted name into brackets.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="p">[</span><span class="s">'album'</span><span class="p">]</span> <span class="c1"># selecting a single column
</span><span class="n">p4k</span><span class="p">[[</span><span class="s">'album'</span><span class="p">,</span><span class="s">'artist'</span><span class="p">]]</span> <span class="c1"># selecting multiple columns
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
    </tr>
    <tr>
      <th>2</th>
      <td>No Shame</td>
      <td>Hopsin</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
    </tr>
    <tr>
      <th>5</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>1999</td>
      <td>Cassius</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 2 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s">'artist'</span><span class="p">:]</span> <span class="c1"># A range of columns can also be selected using the colon (:)
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Wilco</td>
      <td>1</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>Cassius</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Coldcut</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Don Caballero</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Mojave 3</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>1999-01-05</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 6 columns</p>
</div>

<p><strong>Selecting rows</strong> can be done with the .iloc() method which can be sliced with a colon (:)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Returning the first row (as a pandas series)
</span><span class="n">p4k</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span> <span class="c1"># Returning the first 10 rows (as a pandas dataframe)
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Perfect Angel</td>
      <td>Minnie Riperton</td>
      <td>1</td>
      <td>2017-12-05</td>
      <td>Pop/R&amp;B</td>
      <td>Best new reissue A deluxe reissue of Minnie Ri...</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Everyday Is Christmas</td>
      <td>Sia</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Pop/R&amp;B</td>
      <td>Sias shiny Christmas album feels inconsistent...</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Zaytown Sorority Class of 2017</td>
      <td>Zaytoven</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rap</td>
      <td>The prolific Atlanta producer enlists 17 women...</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Songs of Experience</td>
      <td>U2</td>
      <td>0</td>
      <td>2017-12-04</td>
      <td>Rock</td>
      <td>Years in the making, U2s 14th studio album fi...</td>
      <td>5.3</td>
    </tr>
  </tbody>
</table>
</div>

<p>Counting non-numeric data with <strong>.value_counts()</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="p">[</span><span class="s">'genre'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="c1"># p4k['genre'].value_counts()/p4k.shape[0] -- getting proportions instead of counts
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rock            6958
Electronic      4020
None            2324
Experimental    1699
Rap             1481
Pop/R&amp;B         1157
Metal            781
Folk/Country     700
Jazz             257
Global           178
Name: genre, dtype: int64
</code></pre></div></div>

<h2 id="3-adding-or-deleting-columns-and-rows">3. Adding or Deleting Columns and Rows</h2>

<p><em>key methods: .insert(), .append(), .drop()</em></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="p">[</span><span class="s">"Review Language"</span><span class="p">]</span> <span class="o">=</span> <span class="s">'ENG'</span> <span class="c1"># Adding a new column with a universal value:
</span><span class="n">p4k</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>2</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>5</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="s">"Parent Company"</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s">"Vox"</span><span class="p">)</span> <span class="c1"># Second method for adding column with loc
</span><span class="n">p4k</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Vox</td>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vox</td>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vox</td>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Vox</td>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
</div>

<p>Adding a row with <strong>append()</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># creating a new, fake review
</span><span class="n">new_review</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Parent Company'</span><span class="p">:</span><span class="s">'Vox'</span><span class="p">,</span><span class="s">'album'</span><span class="p">:</span><span class="s">'Yandhi'</span><span class="p">,</span><span class="s">'artist'</span><span class="p">:</span><span class="s">'Kanye West'</span><span class="p">,</span>
              <span class="s">'best'</span><span class="p">:</span><span class="s">'1'</span><span class="p">,</span><span class="s">'date'</span><span class="p">:</span><span class="s">'December 31 2050'</span><span class="p">,</span><span class="s">'genre'</span><span class="p">:</span><span class="s">'Rap'</span><span class="p">,</span><span class="s">'review'</span><span class="p">:</span><span class="s">'BEST.ALBUM.EVER'</span><span class="p">,</span>
              <span class="s">'score'</span><span class="p">:</span><span class="mf">10.0</span><span class="p">,</span><span class="s">'Review Language'</span><span class="p">:</span><span class="s">'ENG'</span><span class="p">}</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_review</span><span class="p">,</span><span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># ignore_index allows the new row(s) to be inserted seemlessly
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vox</td>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>2017-12-06 00:00:00</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06 00:00:00</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Vox</td>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06 00:00:00</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vox</td>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06 00:00:00</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vox</td>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05 00:00:00</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>Vox</td>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0</td>
      <td>1999-01-26 00:00:00</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Vox</td>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0</td>
      <td>1999-01-12 00:00:00</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Vox</td>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0</td>
      <td>1999-01-12 00:00:00</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Vox</td>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>1999-01-05 00:00:00</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>Vox</td>
      <td>Yandhi</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>December 31 2050</td>
      <td>Rap</td>
      <td>BEST.ALBUM.EVER</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
<p>19556 rows × 9 columns</p>
</div>

<p>Dropping rows and columns with <strong>.drop()</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># returns a dataframe w/out the observation with index label '1'
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vox</td>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vox</td>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Vox</td>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Vox</td>
      <td>Perfect Angel</td>
      <td>Minnie Riperton</td>
      <td>1</td>
      <td>2017-12-05</td>
      <td>Pop/R&amp;B</td>
      <td>Best new reissue A deluxe reissue of Minnie Ri...</td>
      <td>9.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>Vox</td>
      <td>1999</td>
      <td>Cassius</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Vox</td>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Vox</td>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Vox</td>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>Vox</td>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>1999-01-05</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
<p>19554 rows × 9 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s">"Parent Company"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># or
</span><span class="n">p4k</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s">"Parent Company"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s">"columns"</span><span class="p">)</span>

<span class="c1"># multiple columns
# p4k.drop(["Parent Company","date"], axis="columns")
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>2</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>5</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>1999</td>
      <td>Cassius</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>1999-01-05</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 8 columns</p>
</div>

<h2 id="4-filtering">4. Filtering</h2>

<p><em>key methods: .isn(), .between(), .where(), .query()</em></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Boolean filtering
</span><span class="n">p4k</span><span class="p">[</span><span class="n">p4k</span><span class="p">[</span><span class="s">"artist"</span><span class="p">]</span><span class="o">==</span><span class="s">"Prince"</span><span class="p">]</span>
<span class="n">p4k</span><span class="p">[</span><span class="n">p4k</span><span class="p">[</span><span class="s">"genre"</span><span class="p">]</span> <span class="o">==</span> <span class="s">"Global"</span><span class="p">]</span>
<span class="c1">#p4k[p4k["genre"] != "Metal"] # Filter negated with '!='
</span><span class="n">p4k</span><span class="p">[</span><span class="n">p4k</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">9.5</span><span class="p">]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1599</th>
      <td>Vox</td>
      <td>One Nite Alone, The Aftershow: It Ain't Over!</td>
      <td>Prince</td>
      <td>1</td>
      <td>September 1 2016</td>
      <td>Pop/R&amp;B</td>
      <td>Best new reissue Originally released as part o...</td>
      <td>8.6</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>2042</th>
      <td>Vox</td>
      <td>Sign "O" the Times</td>
      <td>Prince</td>
      <td>0</td>
      <td>April 30 2016</td>
      <td>Pop/R&amp;B</td>
      <td>Choosing a single high point from Prince's glo...</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>2043</th>
      <td>Vox</td>
      <td>1999</td>
      <td>Prince</td>
      <td>0</td>
      <td>April 30 2016</td>
      <td>Pop/R&amp;B</td>
      <td>1999 is the greatest album ever made about par...</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>2047</th>
      <td>Vox</td>
      <td>Dirty Mind</td>
      <td>Prince</td>
      <td>0</td>
      <td>April 29 2016</td>
      <td>Pop/R&amp;B</td>
      <td>Princes first fully actualized album is an un...</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>2048</th>
      <td>Vox</td>
      <td>Controversy</td>
      <td>Prince</td>
      <td>0</td>
      <td>April 29 2016</td>
      <td>Pop/R&amp;B</td>
      <td>Controversy emerged in 1981 at a pivotal time ...</td>
      <td>9.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>2444</th>
      <td>Vox</td>
      <td>HITNRUN Phase Two</td>
      <td>Prince</td>
      <td>0</td>
      <td>January 8 2016</td>
      <td>Pop/R&amp;B</td>
      <td>The second of Prince's HITNRUN series is anoth...</td>
      <td>4.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>2779</th>
      <td>Vox</td>
      <td>HITNRUN Phase One</td>
      <td>Prince</td>
      <td>0</td>
      <td>September 10 2015</td>
      <td>Pop/R&amp;B</td>
      <td>Prince's new effort, exclusive to Jay Z's Tida...</td>
      <td>4.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>12334</th>
      <td>Vox</td>
      <td>Planet Earth</td>
      <td>Prince</td>
      <td>0</td>
      <td>July 23 2007</td>
      <td>Pop/R&amp;B</td>
      <td>So far this year Prince has wowed at the Super...</td>
      <td>4.8</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>13400</th>
      <td>Vox</td>
      <td>Ultimate Prince</td>
      <td>Prince</td>
      <td>0</td>
      <td>September 5 2006</td>
      <td>Pop/R&amp;B</td>
      <td>This Prince best of covers the Warner Brothers...</td>
      <td>8.6</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>13946</th>
      <td>Vox</td>
      <td>3121</td>
      <td>Prince</td>
      <td>0</td>
      <td>March 20 2006</td>
      <td>Pop/R&amp;B</td>
      <td>On his latest release, the rock legend betters...</td>
      <td>6.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>16164</th>
      <td>Vox</td>
      <td>Musicology</td>
      <td>Prince</td>
      <td>0</td>
      <td>April 28 2004</td>
      <td>Pop/R&amp;B</td>
      <td>One of the first things a rock critic learns i...</td>
      <td>5.8</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Multiple conditions
</span><span class="n">condition1</span> <span class="o">=</span> <span class="n">p4k</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">9.3</span>
<span class="n">condition2</span> <span class="o">=</span> <span class="n">p4k</span><span class="p">[</span><span class="s">"genre"</span><span class="p">]</span> <span class="o">==</span> <span class="s">"Global"</span>
<span class="n">p4k</span><span class="p">[</span><span class="n">condition1</span> <span class="o">&amp;</span> <span class="n">condition2</span><span class="p">]</span> <span class="c1"># filtering on both
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1568</th>
      <td>Vox</td>
      <td>Caetano Veloso</td>
      <td>Caetano Veloso</td>
      <td>0</td>
      <td>September 11 2016</td>
      <td>Global</td>
      <td>In 1968, the Brazilian pop singer began a Trop...</td>
      <td>9.4</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="p">[</span><span class="n">condition1</span> <span class="o">|</span> <span class="n">condition2</span><span class="p">]</span> <span class="c1"># filtering on either conditions
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14</th>
      <td>Vox</td>
      <td>Master of Puppets</td>
      <td>Metallica</td>
      <td>1</td>
      <td>December 2 2017</td>
      <td>Metal</td>
      <td>Best new reissue In 1986, Metallica released i...</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>119</th>
      <td>Vox</td>
      <td>Walk Among Us</td>
      <td>Misfits</td>
      <td>0</td>
      <td>October 31 2017</td>
      <td>Metal</td>
      <td>They were outliers when they started, but by t...</td>
      <td>9.4</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>128</th>
      <td>Vox</td>
      <td>I Can Hear the Heart Beating as One</td>
      <td>Yo La Tengo</td>
      <td>0</td>
      <td>October 29 2017</td>
      <td>Rock</td>
      <td>Twenty years on from its original release, Yo ...</td>
      <td>9.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Vox</td>
      <td>The Queen Is Dead</td>
      <td>The Smiths</td>
      <td>0</td>
      <td>October 22 2017</td>
      <td>Rock</td>
      <td>Newly reissued as a boxed set, the Smiths 198...</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>218</th>
      <td>Vox</td>
      <td>Ash</td>
      <td>Ibeyi</td>
      <td>1</td>
      <td>October 4 2017</td>
      <td>Global</td>
      <td>Best new music On their second album, the Fren...</td>
      <td>8.3</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19473</th>
      <td>Vox</td>
      <td>Agaetis Byrjun</td>
      <td>Sigur Rós</td>
      <td>0</td>
      <td>June 1 1999</td>
      <td>Rock</td>
      <td>Icelandic lore tells of the Hidden People who ...</td>
      <td>9.4</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19475</th>
      <td>Vox</td>
      <td>Livro</td>
      <td>Caetano Veloso</td>
      <td>0</td>
      <td>June 1 1999</td>
      <td>Global</td>
      <td>I heard somewhere that a person's tastes chang...</td>
      <td>9.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19490</th>
      <td>Vox</td>
      <td>Mule Variations</td>
      <td>Tom Waits</td>
      <td>0</td>
      <td>April 27 1999</td>
      <td>Rock</td>
      <td>I once took a poetry workshop taught by a guy ...</td>
      <td>9.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19520</th>
      <td>Vox</td>
      <td>Brand New Secondhand</td>
      <td>Roots Manuva</td>
      <td>0</td>
      <td>March 23 1999</td>
      <td>Electronic</td>
      <td>For politcially unaware, socially unconscious,...</td>
      <td>9.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19535</th>
      <td>Vox</td>
      <td>Summerteeth</td>
      <td>Wilco</td>
      <td>0</td>
      <td>February 28 1999</td>
      <td>Rock</td>
      <td>After parting ways with Uncle Tupelo partner J...</td>
      <td>9.4</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
<p>403 rows × 9 columns</p>
</div>

<p>The <strong>.isin()</strong> method</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="p">[</span><span class="n">p4k</span><span class="p">[</span><span class="s">"genre"</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s">"Global"</span><span class="p">,</span><span class="s">"Jazz"</span><span class="p">])]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Vox</td>
      <td>4444</td>
      <td>Sam Gendel</td>
      <td>0</td>
      <td>November 29 2017</td>
      <td>Jazz</td>
      <td>Sam Gendels smoothly psychedelic debut is dom...</td>
      <td>7.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Vox</td>
      <td>Tauhid/Jewels of Thought/Deaf Dumb Blind (Summ...</td>
      <td>Pharoah Sanders</td>
      <td>1</td>
      <td>November 10 2017</td>
      <td>Jazz</td>
      <td>Best new reissue Best new reissue 1 / 3 Albums...</td>
      <td>8.2</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>157</th>
      <td>Vox</td>
      <td>The Centennial Trilogy</td>
      <td>Christian Scott aTunde Adjuah</td>
      <td>0</td>
      <td>October 21 2017</td>
      <td>Jazz</td>
      <td>1 / 3 Albums On the three albums that compose ...</td>
      <td>7.6</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Vox</td>
      <td>The Magic City / My Brother the Wind Vol. 1</td>
      <td>Sun Ra and His Arkestra</td>
      <td>0</td>
      <td>October 16 2017</td>
      <td>Jazz</td>
      <td>1 / 2 Albums Sun Ra manifested an ecstatic vis...</td>
      <td>8.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>208</th>
      <td>Vox</td>
      <td>Dreams and Daggers</td>
      <td>Cécile McLorin Salvant</td>
      <td>0</td>
      <td>October 7 2017</td>
      <td>Jazz</td>
      <td>The young jazz singers live double album show...</td>
      <td>7.6</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19261</th>
      <td>Vox</td>
      <td>Permutation</td>
      <td>Bill Laswell</td>
      <td>0</td>
      <td>March 31 2000</td>
      <td>Global</td>
      <td>If there's one thing Bill Laswell knows, it's ...</td>
      <td>6.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19276</th>
      <td>Vox</td>
      <td>Expensive Shit/He Miss Road</td>
      <td>Fela Kuti</td>
      <td>0</td>
      <td>March 21 2000</td>
      <td>Global</td>
      <td>Afro-beat pioneer Fela Kuti was never more pis...</td>
      <td>8.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19280</th>
      <td>Vox</td>
      <td>Treader</td>
      <td>Spring Heel Jack</td>
      <td>0</td>
      <td>March 21 2000</td>
      <td>Jazz</td>
      <td>Isn't it kind of alarming that the once cuttin...</td>
      <td>5.4</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19467</th>
      <td>Vox</td>
      <td>Interstellar Space Revisited: The Music of Joh...</td>
      <td>Gregg Bendian / Nels Cline</td>
      <td>0</td>
      <td>June 8 1999</td>
      <td>Jazz</td>
      <td>A friend of mine once remarked about the later...</td>
      <td>7.9</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19475</th>
      <td>Vox</td>
      <td>Livro</td>
      <td>Caetano Veloso</td>
      <td>0</td>
      <td>June 1 1999</td>
      <td>Global</td>
      <td>I heard somewhere that a person's tastes chang...</td>
      <td>9.0</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
<p>435 rows × 9 columns</p>
</div>

<p>The <strong>.between()</strong> method</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="p">[</span><span class="n">p4k</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mf">3.4</span><span class="p">,</span><span class="mf">3.6</span><span class="p">)]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>December 6 2017</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>1200</th>
      <td>Vox</td>
      <td>December 99th</td>
      <td>Yasiin Bey</td>
      <td>0</td>
      <td>January 2 2017</td>
      <td>Rap</td>
      <td>On December 99th, Yasiin Bey (fka Mos Def) sou...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>1348</th>
      <td>Vox</td>
      <td>Collage</td>
      <td>The Chainsmokers</td>
      <td>0</td>
      <td>November 9 2016</td>
      <td>Electronic</td>
      <td>The massive lite-EDM duo the Chainsmokers port...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>1775</th>
      <td>Vox</td>
      <td>New Introductory Lectures on the System of Tra...</td>
      <td>Kel Valhaal</td>
      <td>0</td>
      <td>July 15 2016</td>
      <td>Experimental</td>
      <td>Liturgy frontman Hunter Hunt-Hendrix's latest ...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>1808</th>
      <td>Vox</td>
      <td>Primary Colours</td>
      <td>Magic!</td>
      <td>0</td>
      <td>July 6 2016</td>
      <td>Pop/R&amp;B</td>
      <td>After scoring a #1 hit with 2014's "Rude,"  th...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>18797</th>
      <td>Vox</td>
      <td>Bleed American</td>
      <td>Jimmy Eat World</td>
      <td>0</td>
      <td>August 21 2001</td>
      <td>Rock</td>
      <td>Are you a 15-year-old TRL addict looking for a...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19072</th>
      <td>Vox</td>
      <td>Dream Signals in Full Circles</td>
      <td>Tristeza</td>
      <td>0</td>
      <td>September 26 2000</td>
      <td>Rock</td>
      <td>In the beginning, there was Nothing. And it wa...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19336</th>
      <td>Vox</td>
      <td>The Past Was Faster</td>
      <td>Kelley Stoltz</td>
      <td>0</td>
      <td>December 14 1999</td>
      <td>Rock</td>
      <td>There's an upside and a downside to the perpet...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19394</th>
      <td>Vox</td>
      <td>Cobra and Phases Group Play Voltage in the Mil...</td>
      <td>Stereolab</td>
      <td>0</td>
      <td>September 21 1999</td>
      <td>Experimental</td>
      <td>"Okay, Brent, this is getting really old." "Wh...</td>
      <td>3.4</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19454</th>
      <td>Vox</td>
      <td>The Seduction of Claude Debussy</td>
      <td>Art of Noise</td>
      <td>0</td>
      <td>June 29 1999</td>
      <td>Electronic</td>
      <td>Tonite during Prime Time: Channel 02: "The Art...</td>
      <td>3.6</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
<p>91 rows × 9 columns</p>
</div>

<p>The <strong>.where()</strong> method which returns the original dataframe with NAs in rows that don’t meet the criteria</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p4k</span><span class="p">[</span><span class="s">"genre"</span><span class="p">]</span><span class="o">==</span><span class="s">"Rap"</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 9 columns</p>
</div>

<p>The <strong>.query()</strong> method is very readable, but since the conditions are wrapped in single quotes, it will not work if there are spaces in the column names</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s">'best==1.0'</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Vox</td>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Vox</td>
      <td>Perfect Angel</td>
      <td>Minnie Riperton</td>
      <td>1</td>
      <td>December 5 2017</td>
      <td>Pop/R&amp;B</td>
      <td>Best new reissue A deluxe reissue of Minnie Ri...</td>
      <td>9.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Vox</td>
      <td>Master of Puppets</td>
      <td>Metallica</td>
      <td>1</td>
      <td>December 2 2017</td>
      <td>Metal</td>
      <td>Best new reissue In 1986, Metallica released i...</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Vox</td>
      <td>Kick</td>
      <td>INXS</td>
      <td>1</td>
      <td>December 1 2017</td>
      <td>Rock</td>
      <td>Best new reissue The 30th-anniversary edition ...</td>
      <td>8.4</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Vox</td>
      <td>Utopia</td>
      <td>Björk</td>
      <td>1</td>
      <td>November 27 2017</td>
      <td>Electronic</td>
      <td>Best new music Filled with flute and birdsong,...</td>
      <td>8.4</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17501</th>
      <td>Vox</td>
      <td>Do You Party?</td>
      <td>The Soft Pink Truth</td>
      <td>1</td>
      <td>February 4 2003</td>
      <td>Electronic</td>
      <td>Best new music There will be big fun in town t...</td>
      <td>8.4</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>17511</th>
      <td>Vox</td>
      <td>You Forgot It in People</td>
      <td>Broken Social Scene</td>
      <td>1</td>
      <td>February 2 2003</td>
      <td>Rock</td>
      <td>Best new music It's a bit late to be talking a...</td>
      <td>9.2</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>17551</th>
      <td>Vox</td>
      <td>Everything Is Good Here/Please Come Home</td>
      <td>The Angels of Light</td>
      <td>1</td>
      <td>January 20 2003</td>
      <td>None</td>
      <td>Best new music To a certain extent, most of us...</td>
      <td>8.6</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>17554</th>
      <td>Vox</td>
      <td>Mount Eerie</td>
      <td>The Microphones</td>
      <td>1</td>
      <td>January 20 2003</td>
      <td>Experimental</td>
      <td>Best new music Growing up in the shadow of Mt....</td>
      <td>8.9</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>17562</th>
      <td>Vox</td>
      <td>S.T.R.E.E.T. D.A.D.</td>
      <td>Out Hud</td>
      <td>1</td>
      <td>January 15 2003</td>
      <td>Electronic</td>
      <td>Best new music Language is for suckers, but du...</td>
      <td>9.0</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
<p>1040 rows × 9 columns</p>
</div>

<h2 id="5-ranking--sorting">5. Ranking &amp; Sorting</h2>

<p><em>key methods: .sort_values(), .sort_index(), .rank(), .nsmallest(), .nlargest()</em></p>

<p>Sorting of values is done with the <strong>.sort_values()</strong> method or <strong>.sort_index()</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">"score"</span><span class="p">,</span>
               <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="c1"># default is ascending=True
</span>               <span class="n">na_position</span><span class="o">=</span><span class="s">"first"</span><span class="p">,</span> <span class="c1"># position of na values. options include "first","last"
</span>               <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># argument to replace 'p4k' dataframe with sorted output
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s">'score'</span><span class="p">,</span><span class="s">'artist'</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="bp">False</span><span class="p">,</span><span class="bp">False</span><span class="p">])</span> <span class="c1"># multiple parameters to sort by
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1162</th>
      <td>Vox</td>
      <td>Germfree Adolescents</td>
      <td>X-Ray Spex</td>
      <td>0</td>
      <td>January 15 2017</td>
      <td>Rock</td>
      <td>X-Ray Spexs debut album is a brash, vivid mas...</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>13782</th>
      <td>Vox</td>
      <td>Pink Flag / Chairs Missing / 154</td>
      <td>Wire</td>
      <td>0</td>
      <td>May 5 2006</td>
      <td>Rock</td>
      <td>1 / 3 Albums Wire were born at the dawn of pun...</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>6049</th>
      <td>Vox</td>
      <td>The Disintegration Loops</td>
      <td>William Basinski</td>
      <td>1</td>
      <td>November 19 2012</td>
      <td>Experimental</td>
      <td>Best new reissue The four volumes of William B...</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>18222</th>
      <td>Vox</td>
      <td>Yankee Hotel Foxtrot</td>
      <td>Wilco</td>
      <td>0</td>
      <td>April 21 2002</td>
      <td>Rock</td>
      <td>Myth, it has been said, is the buried part of ...</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>1004</th>
      <td>Vox</td>
      <td>Weezer (Blue Album)</td>
      <td>Weezer</td>
      <td>0</td>
      <td>February 26 2017</td>
      <td>Rock</td>
      <td>Weezers 1994 debut, filled with geeky humor, ...</td>
      <td>10.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>15690</th>
      <td>Vox</td>
      <td>Travistan</td>
      <td>Travis Morrison</td>
      <td>0</td>
      <td>September 27 2004</td>
      <td>Pop/R&amp;B</td>
      <td>After a prestigious and fruitful career fronti...</td>
      <td>0.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19228</th>
      <td>Vox</td>
      <td>NYC Ghosts &amp; Flowers</td>
      <td>Sonic Youth</td>
      <td>0</td>
      <td>April 30 2000</td>
      <td>Rock</td>
      <td>No, I have not forgotten to put the numbers in...</td>
      <td>0.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>15048</th>
      <td>Vox</td>
      <td>Relaxation of the Asshole</td>
      <td>Robert Pollard</td>
      <td>0</td>
      <td>April 20 2005</td>
      <td>Rock</td>
      <td>If more drunks would learn from Robert Pollard...</td>
      <td>0.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>17050</th>
      <td>Vox</td>
      <td>Liz Phair</td>
      <td>Liz Phair</td>
      <td>0</td>
      <td>June 24 2003</td>
      <td>Rock</td>
      <td>It could be said that Liz Phair's greatest ass...</td>
      <td>0.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>13301</th>
      <td>Vox</td>
      <td>Shine On</td>
      <td>Jet</td>
      <td>0</td>
      <td>October 2 2006</td>
      <td>Rock</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 9 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># reverting to original dataframe by sorting by index
</span><span class="n">p4k</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Vox</td>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>December 6 2017</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vox</td>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vox</td>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>December 6 2017</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Vox</td>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>December 5 2017</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>Vox</td>
      <td>1999</td>
      <td>Cassius</td>
      <td>0</td>
      <td>January 26 1999</td>
      <td>Electronic</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Vox</td>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0</td>
      <td>January 26 1999</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Vox</td>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0</td>
      <td>January 12 1999</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Vox</td>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0</td>
      <td>January 12 1999</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>ENG</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>Vox</td>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>January 5 1999</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>ENG</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 9 columns</p>
</div>

<p>Ranking is done with <strong>.rank()</strong> method, while individual extreme records can be returned with <strong>.nlargest()</strong> and <strong>.nsmallest()</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1         7976.0
2          402.0
3         5494.0
4        13486.5
5         5932.0
          ...   
19551     1133.0
19552    18931.0
19553     9370.0
19554     4286.0
19555     5069.5
Name: score, Length: 19555, dtype: float64
</code></pre></div></div>

<p>By default, <strong>.rank()</strong> assign average rankings to values that are equivalent. Different ranking methods can be applied by using the method parameter:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'min'</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c1"># Min assigns lowest ranking for observations with the same values
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1        11104.0
2        19131.0
3        13879.0
4         5691.0
5        13370.0
          ...   
19551    18368.0
19552      587.0
19553     9807.0
19554    15110.0
19555    14246.0
Name: score, Length: 19555, dtype: float64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Adding score_rank to the dataframe as a new column
</span><span class="n">p4k</span><span class="p">[</span><span class="s">'score_rank'</span><span class="p">]</span><span class="o">=</span><span class="n">p4k</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'min'</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">p4k</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">"score_rank"</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">na_position</span><span class="o">=</span><span class="s">"first"</span><span class="p">)</span>  
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9787</th>
      <td>Vox</td>
      <td>Abbey Road</td>
      <td>The Beatles</td>
      <td>0</td>
      <td>September 10 2009</td>
      <td>Rock</td>
      <td>The perfect ending to a recording career, this...</td>
      <td>10.0</td>
      <td>ENG</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2280</th>
      <td>Vox</td>
      <td>Off the Wall</td>
      <td>Michael Jackson</td>
      <td>1</td>
      <td>February 24 2016</td>
      <td>Pop/R&amp;B</td>
      <td>Best new reissue Off the Wall is the sound of ...</td>
      <td>10.0</td>
      <td>ENG</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7272</th>
      <td>Vox</td>
      <td>The Smile Sessions</td>
      <td>The Beach Boys</td>
      <td>1</td>
      <td>November 2 2011</td>
      <td>Rock</td>
      <td>Best new reissue Conceived, recorded, and ulti...</td>
      <td>10.0</td>
      <td>ENG</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9784</th>
      <td>Vox</td>
      <td>The Stone Roses</td>
      <td>The Stone Roses</td>
      <td>1</td>
      <td>September 11 2009</td>
      <td>Rock</td>
      <td>Best new reissue A badly needed remaster of th...</td>
      <td>10.0</td>
      <td>ENG</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9261</th>
      <td>Vox</td>
      <td>Ladies and Gentlemen We are Floating in Space ...</td>
      <td>Spiritualized</td>
      <td>1</td>
      <td>March 2 2010</td>
      <td>Experimental</td>
      <td>Best new reissue This new deluxe, limited prod...</td>
      <td>10.0</td>
      <td>ENG</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13301</th>
      <td>Vox</td>
      <td>Shine On</td>
      <td>Jet</td>
      <td>0</td>
      <td>October 2 2006</td>
      <td>Rock</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>ENG</td>
      <td>19550.0</td>
    </tr>
    <tr>
      <th>19228</th>
      <td>Vox</td>
      <td>NYC Ghosts &amp; Flowers</td>
      <td>Sonic Youth</td>
      <td>0</td>
      <td>April 30 2000</td>
      <td>Rock</td>
      <td>No, I have not forgotten to put the numbers in...</td>
      <td>0.0</td>
      <td>ENG</td>
      <td>19550.0</td>
    </tr>
    <tr>
      <th>12223</th>
      <td>Vox</td>
      <td>This Is Next</td>
      <td>Various Artists</td>
      <td>0</td>
      <td>August 22 2007</td>
      <td>None</td>
      <td>Basically an ADA sampler with a promotional st...</td>
      <td>0.0</td>
      <td>ENG</td>
      <td>19550.0</td>
    </tr>
    <tr>
      <th>17050</th>
      <td>Vox</td>
      <td>Liz Phair</td>
      <td>Liz Phair</td>
      <td>0</td>
      <td>June 24 2003</td>
      <td>Rock</td>
      <td>It could be said that Liz Phair's greatest ass...</td>
      <td>0.0</td>
      <td>ENG</td>
      <td>19550.0</td>
    </tr>
    <tr>
      <th>15048</th>
      <td>Vox</td>
      <td>Relaxation of the Asshole</td>
      <td>Robert Pollard</td>
      <td>0</td>
      <td>April 20 2005</td>
      <td>Rock</td>
      <td>If more drunks would learn from Robert Pollard...</td>
      <td>0.0</td>
      <td>ENG</td>
      <td>19550.0</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 10 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">"score"</span><span class="p">)</span>
<span class="c1"># Alternative method which returns the records' index labels
#p4k["score"].nsmallest(n=4)
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12223</th>
      <td>Vox</td>
      <td>This Is Next</td>
      <td>Various Artists</td>
      <td>0</td>
      <td>August 22 2007</td>
      <td>None</td>
      <td>Basically an ADA sampler with a promotional st...</td>
      <td>0.0</td>
      <td>ENG</td>
      <td>19550.0</td>
    </tr>
    <tr>
      <th>13301</th>
      <td>Vox</td>
      <td>Shine On</td>
      <td>Jet</td>
      <td>0</td>
      <td>October 2 2006</td>
      <td>Rock</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>ENG</td>
      <td>19550.0</td>
    </tr>
    <tr>
      <th>15048</th>
      <td>Vox</td>
      <td>Relaxation of the Asshole</td>
      <td>Robert Pollard</td>
      <td>0</td>
      <td>April 20 2005</td>
      <td>Rock</td>
      <td>If more drunks would learn from Robert Pollard...</td>
      <td>0.0</td>
      <td>ENG</td>
      <td>19550.0</td>
    </tr>
    <tr>
      <th>15690</th>
      <td>Vox</td>
      <td>Travistan</td>
      <td>Travis Morrison</td>
      <td>0</td>
      <td>September 27 2004</td>
      <td>Pop/R&amp;B</td>
      <td>After a prestigious and fruitful career fronti...</td>
      <td>0.0</td>
      <td>ENG</td>
      <td>19550.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#p4k.nlargest(n=4, columns="score")
# Alternative method which returns the records' index labels
</span><span class="n">p4k</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>14     10.0
154    10.0
506    10.0
566    10.0
Name: score, dtype: float64
</code></pre></div></div>

<h2 id="6-working-with-nas">6. Working with NAs</h2>

<p><em>key methods: .isnull(), .notnull(), .dropna(), .fillna()</em></p>

<p>There are a variety of methods to identify, remove, and replace NA values</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># adding a NA row to the data.frame
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">NA_Row</span> <span class="o">=</span> <span class="p">{</span><span class="s">'album'</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="s">'artist'</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="s">'best'</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="s">'genre'</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="s">'review'</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="s">'score'</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">}</span>
<span class="n">NA_Row</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'album': nan,
 'artist': nan,
 'best': nan,
 'genre': nan,
 'review': nan,
 'score': nan}
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span> <span class="o">=</span> <span class="n">p4k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NA_Row</span><span class="p">,</span><span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">p4k</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vox</td>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1.0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
      <td>11104.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
      <td>19131.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Vox</td>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>ENG</td>
      <td>13879.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vox</td>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
      <td>5691.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vox</td>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0.0</td>
      <td>December 5 2017</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
      <td>13370.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>Vox</td>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0.0</td>
      <td>January 26 1999</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
      <td>ENG</td>
      <td>587.0</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Vox</td>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>ENG</td>
      <td>9807.0</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Vox</td>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>ENG</td>
      <td>15110.0</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Vox</td>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0.0</td>
      <td>January 5 1999</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>ENG</td>
      <td>14246.0</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>19556 rows × 10 columns</p>
</div>

<p>Null values can be identifed using <strong>.isnull()</strong>, while <strong>.notnull()</strong> can be used for the opposite. Both return boolean values.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>19556 rows × 10 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>19556 rows × 10 columns</p>
</div>

<p>The <strong>.dropna()</strong> method allows for multiple ways to drop NaN values:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># drops any value with a NA
</span><span class="n">p4k</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1">#only removes rows with NAs in all values
</span><span class="n">p4k</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s">"all"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Remove columns with any na values -- in this case, all columns
</span><span class="n">p4k</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Only dropping observations where there are nulls in "Salary" column
</span><span class="n">p4k</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">"album"</span><span class="p">])</span>

</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vox</td>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1.0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
      <td>11104.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
      <td>19131.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Vox</td>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>ENG</td>
      <td>13879.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vox</td>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
      <td>5691.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vox</td>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0.0</td>
      <td>December 5 2017</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
      <td>13370.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19550</th>
      <td>Vox</td>
      <td>1999</td>
      <td>Cassius</td>
      <td>0.0</td>
      <td>January 26 1999</td>
      <td>Electronic</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
      <td>ENG</td>
      <td>18368.0</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>Vox</td>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0.0</td>
      <td>January 26 1999</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
      <td>ENG</td>
      <td>587.0</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Vox</td>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>ENG</td>
      <td>9807.0</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Vox</td>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>ENG</td>
      <td>15110.0</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Vox</td>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0.0</td>
      <td>January 5 1999</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>ENG</td>
      <td>14246.0</td>
    </tr>
  </tbody>
</table>
<p>19549 rows × 10 columns</p>
</div>

<p>The <strong>.fillna()</strong> method allows for automaic filling of NA values</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1"># will replace all NAs within the datafram with 0 (not ideal)
</span><span class="n">p4k</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vox</td>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1.0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
      <td>11104.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
      <td>19131.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Vox</td>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>ENG</td>
      <td>13879.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vox</td>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
      <td>5691.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vox</td>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0.0</td>
      <td>December 5 2017</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
      <td>13370.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>Vox</td>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0.0</td>
      <td>January 26 1999</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
      <td>ENG</td>
      <td>587.0</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Vox</td>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>ENG</td>
      <td>9807.0</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Vox</td>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>ENG</td>
      <td>15110.0</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Vox</td>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0.0</td>
      <td>January 5 1999</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>ENG</td>
      <td>14246.0</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>19556 rows × 10 columns</p>
</div>

<h2 id="7-unique-and-duplicate-values">7. Unique and Duplicate values</h2>

<p><em>key methods: .unique(), .nunique(), .duplicated(), .drop_duplicates()</em></p>

<p>Two methods for identifying unique values are <strong>.unique()</strong> which returns an array of unique values, while <strong>.nunique()</strong> counts those unique values</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="p">[</span><span class="s">'genre'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array(['Rock', 'Rap', 'Pop/R&amp;B', 'Metal', 'None', 'Electronic',
       'Experimental', 'Folk/Country', 'Jazz', 'Global', nan],
      dtype=object)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># dropna parameter will not include nan's in the count
</span><span class="n">p4k</span><span class="p">[</span><span class="s">'genre'</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10
</code></pre></div></div>

<p><strong>.duplicated()</strong> and <strong>.drop_duplicates</strong> are methods for identifying and removing duplicate rows in a dataframe.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s">"First Name"</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s">"first"</span><span class="p">)</span> <span class="c1"># by default, only the first observation of a value is not seen as a duplicate
</span><span class="n">df</span><span class="p">[</span><span class="s">"First Name"</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s">"last"</span><span class="p">)</span> <span class="c1"># running from the bottom up
</span><span class="n">df</span><span class="p">[</span><span class="s">"First Name"</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span> <span class="bp">False</span><span class="p">)</span> <span class="c1"># identifys all values that are duplciated
</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">"First Name"</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span> <span class="bp">False</span><span class="p">)]</span> <span class="c1"># keeping any values that are duplicated
</span><span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s">"First Name"</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span> <span class="c1"># '~' negates to get all values which have no duplicates
</span>

</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># returns boolean
</span><span class="n">p4k</span><span class="p">[</span><span class="s">'genre'</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>

<span class="c1"># by default, only the first observation of a value is not seen as a duplicate
</span><span class="n">p4k</span><span class="p">[</span><span class="s">'genre'</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s">"first"</span><span class="p">)</span>

<span class="c1"># running from the bottom up
</span><span class="n">p4k</span><span class="p">[</span><span class="s">'genre'</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s">"last"</span><span class="p">)</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0         True
1         True
2         True
3         True
4         True
         ...  
19551    False
19552    False
19553    False
19554    False
19555    False
Name: genre, Length: 19556, dtype: bool
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># identifys all values that are duplciated
</span><span class="n">p4k</span><span class="p">[</span><span class="s">'genre'</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

<span class="c1"># keeping any values that are duplicated (all rows except NA row)
</span><span class="n">p4k</span><span class="p">[</span><span class="n">p4k</span><span class="p">[</span><span class="s">'genre'</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span> <span class="bp">False</span><span class="p">)]</span>

<span class="c1"># '~' negates to get all values which have no duplicates (only NA row)
</span><span class="n">p4k</span><span class="p">[</span><span class="o">~</span><span class="n">p4k</span><span class="p">[</span><span class="s">'genre'</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span>

</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19555</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># only dropping duplicates in the score column, keeping first obs
</span><span class="n">p4k</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">"score"</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="s">"first"</span><span class="p">)</span>

<span class="c1"># dropping all duplicated artists, only returning artists w/one review
</span><span class="n">p4k</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">"artist"</span><span class="p">],</span> <span class="n">keep</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

<span class="c1"># Can drop duplicates across multiple columns
</span><span class="n">p4k</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s">"genre"</span><span class="p">,</span> <span class="s">"date"</span><span class="p">])</span>

</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vox</td>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1.0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
      <td>11104.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
      <td>19131.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vox</td>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
      <td>5691.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vox</td>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0.0</td>
      <td>December 5 2017</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
      <td>13370.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Vox</td>
      <td>Perfect Angel</td>
      <td>Minnie Riperton</td>
      <td>1.0</td>
      <td>December 5 2017</td>
      <td>Pop/R&amp;B</td>
      <td>Best new reissue A deluxe reissue of Minnie Ri...</td>
      <td>9.0</td>
      <td>ENG</td>
      <td>425.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19550</th>
      <td>Vox</td>
      <td>1999</td>
      <td>Cassius</td>
      <td>0.0</td>
      <td>January 26 1999</td>
      <td>Electronic</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
      <td>ENG</td>
      <td>18368.0</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Vox</td>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>ENG</td>
      <td>9807.0</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Vox</td>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>ENG</td>
      <td>15110.0</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Vox</td>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0.0</td>
      <td>January 5 1999</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>ENG</td>
      <td>14246.0</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>13777 rows × 10 columns</p>
</div>

<h2 id="8-working-with-indexes">8. Working with Indexes</h2>

<p><em>key methods: .sort_index(), .set_index(), .reset_index(), .get_level_values(), .swap_levels(), .stack(), .unstack()</em></p>

<p>Indexes in pandas store axis labels for all pandas objects. Indexes can take the form of id values, categorical indexes, multiple indexes, datetime indexes among others.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">index</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Int64Index([    1,     2,     3,     4,     5,     6,     7,     8,     9,
               10,
            ...
            19546, 19547, 19548, 19549, 19550, 19551, 19552, 19553, 19554,
            19555],
           dtype='int64', length=19555)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># returning an array of representing the data in the index
</span><span class="n">p4k</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([['A.M./Being There', 'Wilco', 1, ..., 'Rock',
        'Best new reissue 1 / 2 Albums Newly reissued and remastered, the group\x92s first two albums find Jeff Tweedy and his Chicago band transforming themselves from alt-country also-rans into a formidable rock\x91n\x92roll outfit. The nuclear detonation of Uncle Tupelo launched an alt-country arms race, with the band\x92s two chief singer-songwriters mutating from old friends into bitter enemies trying to outdo each other with their follow-up records. Jay Farrar started Son Volt with Tupelo\x92s drummer, Mike Heidorn, and released Trace, which yielded the radio hit \x93Drown\x94 and found him greeted as a visionary. Jeff Tweedy, on the other hand, rushed into the studio to record a set of demos with his new band, Wilco, barely a couple months after his old band had played its final show. Nearly a year later they released their first album, A.M., which was greeted with a big shrug from critics and fans alike. Tweedy had managed to retain almost every member of Uncle Tupelo\x92s expanded line-up: multi-instrumentalist Max Johnston, guitarist John Stirratt, drummer Ken Coomer, even guitarist Brian Henneman, of the Bottle Rockets. In fact, the group briefly flirted with the idea of keeping the Uncle Tupelo name, although wiser heads prevailed and they rechristened themselves after trucker lingo for \x93will comply.\x94 Still, despite their familiarity and camaraderie, Wilco were still trying to figure out who they were when they wrote and recorded A.M.\x97a necessary step for any band, but especially for one whose de facto frontman had spent the last decade-plus in the shadow of the more forceful Farrar. The original mix of A.M. was, reportedly, much grittier and more akin to Uncle Tupelo\x92s early material than to the cleaner, more polished version that finally made its way into CD stores in March 1995. The final version is fine, although A.M. is the very definition of 1990s alt-country: as conservative as punk rock, with flourishes of pedal steel and a gentle twang to frame Tweedy\x92s hard-luck tales of casino losing streaks, suspended licenses, and custody battles over record collections. \x93I Must Be High\x94 nods toward the sunny pop of Summerteeth and beyond, and \x93Box Full of Letters\x94 and \x93Passenger Side\x94 hint at the melancholy melodicism that would become Tweedy\x92s stock in trade. He wanted Wilco to be a collaborative and democratic unit rather than a glorified solo project, though only one of his bandmates\x92 songs made the final cut: the gently loping \x93It\x92s Just That Simple,\x94 courtesy of Stirratt (who pens the new liner notes for this expanded edition). Otherwise, the MVP of the album is Henneman, who was a fine foil for Tweedy. There\x92s real wit and warmth in his guitar riffs, even if he was merely a rental rather than a full band member. According to Learning How to Die, Greg Kot\x92s 2004 biography of the band, Henneman recorded his part for the raucous throwaway \x93Casino Queen\x94 while nursing a broken heart; he downed two bottles of gin before the tape started rolling, and he plays like he\x92s holding on for dear life. A.M. is an album persistently defined by unfavorable comparisons, first to Son Volt\x92s Trace and later to every other Wilco album. And certainly there\x92s a timidity here that must have been discouraging after Tweedy\x92s strong contributions to Uncle Tupelo\x92s final pair of albums. But there\x92s also a lot of humor and sadness to these songs, which are circumscribed and local in their scope. That\x92s the charm of this modest reissue, which includes only a handful of bonus tracks (including the final Uncle Tupelo recording and a Blue Mountain cover) but treats A.M. as something more than a footnote to Wilco\x92s long career. In 2017, the album plays like a band setting its terms, striving to keep everything perfectly human-size. As much as the band was compared to that other Uncle Tupelo offshoot, Wilco\x92s biggest rivals were themselves. Tweedy, meanwhile, was struggling to grow up. Then in his late 20s, he quit smoking pot, a vice he\x92d adopted after quitting drinking a few years before. He married his girlfriend and prepared to become a father. And he made some painful adjustments to his expectations once A.M. floundered and ticket sales cratered. If he hadn\x92t turned those setbacks into songs, you probably wouldn\x92t be reading a review of any Wilco reissues. Being There is every bit as confident as their debut was shaky: a double album tied together by a loose theme of what it means to be in a rock\x91n\x92roll band. It opens with a big blast of lurching, serrating guitar distortion, sinewy and visceral and violent, which sounds like they\x92re tearing up A.M. so they can start over again. What\x92s amazing is how well it works. After the grinding din that begins and ends opener \x93Misunderstood,\x94 Tweedy\x92s songs have a brand new context. \x93Far, Far Away\x94 and \x93I Got You (At the End of the Century)\x94 aren\x92t actually that different from A.M., but they sound heavier, riskier, the stakes so much greater that it could be a different band altogether. There are some country flourishes, specifically the pedal steel courtesy of Freakwater\x92s Bob Egan, but Wilco had managed to transform itself from an alt-country also-ran into a real rock band: noise rock, classic rock, folk rock, heartland rock, every kind of rock. A conceptually knotty record, Being There contains barely veiled references to a breakup, but most listeners at the time would have understood them as references to Uncle Tupelo rather than a romantic partner. \x93Monday,\x94 with its Stonesy brass stomp, is about a guy in \x93a plenty good band\x94 who can only watch as others get all the glory, and you can guess what might have inspired Tweedy\x92s wry observations about fame and futility.  There are a few pulled punches (\x93I know you\x92re just a mama\x92s boy\x94 doesn\x92t have much sting), but thankfully, these aren\x92t dis tracks or bitter recriminations. Jay Farrar\x92s only a minor concern; these songs are first and foremost about Jeff Tweedy and his misgivings about his own talent. That had been a detriment on A.M.; on Being There it\x92s the band\x92s greatest strength and truest subject. Rock\x91n\x92roll is a sucker\x92s bet on these songs, something you pour your heart and soul and money and labor and dreams into and for what? Creative and financial frustration? \x93We\x92ve got solid-state technology,\x94 Tweedy sings on \x93Red-Eyed and Blue\x94; \x93Tapes on the floor/Some songs we can\x92t afford to play.\x94 So, why were they even doing it? That\x92s what Wilco are trying to figure out on Being There, and they need your help. It\x92s useful to imagine each of these songs being sung from the stage directly and explicitly to the audience who has paid to see Wilco. As Tweedy sings on \x93I Got You (At the End of the Century),\x94 \x93I got you and I still believe that you\x92re all that I will ever need/It\x92s you.\x94 That \x93you\x94 means us. Are we enough for them? Is our applause really that valuable? Being There flirts with cynicism, but really the mood is sober, world-weary, adult. \x93There is no sunken treasure/Rumored to be wrapped inside my ribs,\x94 Tweedy sings on \x93Sunken Treasure,\x94 the slow-burn epic that anchors the second disc of this double album. \x93Music is my savior/I was maimed by rock and roll.\x94 If rock had once been a liberating medium, after Nirvana it had become an albatross around the neck of every dreamer with a guitar. But Tweedy finds his way in the end: Closer \x93Dreamer in My Dreams\x94 may be the most unflinchingly personal song on the record, but it\x92s also the wildest, the wooliest, maybe the most raucous Wilco have ever sounded. \x93Well I know I\x92ve made mistakes,\x94 he sings; \x93I\x92m passing them on.\x94 Just when you think the song is ending, the band kicks it up again, as though reluctant to stop playing. Only when the song ends do they have to face real life again. At the heart of this bruised and tender record is the frazzled relationship between artist and audience, which makes this reissue more powerful and essential than your typical album repackaging. Digital media means we as an audience have less and less to give an artist, and rock\x91n\x92roll may be even more of a fool\x92s errand now than it was in 1996, when people bought CDs by the handful and even a mid-level band like pre-Foxtrot Wilco could make a comfortable living driving around the country in a van. Being There sounds even direr and more desperate than it once did, and the bonus material expands upon its themes. The \x93Party Horn\x94 mix of \x93Monday\x94 actually sounds richer and more excitable than the studio version, especially with its screeching sax solo. Most of the outtakes and alternate takes still have studio chatter attached to them, showing the band goofing around in the studio or half-assing the demos. \x93I think that was good enough,\x94 Tweedy deadpans after a beautifully understated version of \x93Dynamite My Soul.\x94 All of Tweedy\x92s big ideas about his vocation sound even more volatile on the two full live sets included on the 5xCD version, with \x93Sunken Treasure\x94 and \x93Hotel Arizona\x94 making the most of Tweedy\x92s rapport with the audience (\x93This is a true story. Sorta.\x94) and the noise of the crowd. Maybe that\x92s where the album\x92s title comes from. It is, of course, a reference to the 1979 Peter Sellers film, but it\x92s also a twist on the old adage about concerts and concert films: I guess you had to be there. We\x92ve always been a crucial part of Being There, always an unseen force motivating Wilco from one show to the next, but these live cuts make it explicit. It\x92s as though Tweedy played the long game on this sucker\x92s bet, waiting 21 years to make the ultimate version of Being There.',
        7.0],
       ['No Shame', 'Hopsin', 0, ..., 'Rap',
        'On his corrosive fifth album, the rapper takes aim at several targets and whiffs spectacularly. His verbose, tryhard technique is a tired formula he employs without flow, direction, or meaning. Hopsin\x97the California rapper whose constricting flows and humorless turns suck all the fun out of rapping\x97made his reputation appealing to the angstier corners of the internet, inhabited by rap moralists and \x93alternative thinkers\x94\x97those who earnestly think Tech N9ne is Peak Underground Rap. His new album, No Shame, is a bitter, petulant response to recent setbacks and mistakes: the collapse of his Funk Volume label, the souring of personal and professional relationships, and losing custody of his son after pleading guilty to assault. But he refuses to back down. \x93I built this empire off rebellion/Niggas seem to have a problem with what I be sellin\x92,\x94 he raps on \x93Panorama City,\x94 a song using a \x93California Love\x94 sample as a Thug Life signifier. When given the chance to explain himself, he doubles down on the worst aspects of an irritating persona. No Shame is a misfired revenge stunt. He takes aim at several targets and whiffs spectacularly, producing the worst album of his career, filled with tryhard wordplay and defamation that verges on abuse. \x93This album is backlash for somebody else. This album is pretty much just karma for people who have screwed me over or done something wrong to me,\x94 he told Tim Westwood. Those people are his former business partner, manager, and Funk Volume co-founder, Damien Ritter, and his ex-girlfriend, who Hopsin was arrested for assaulting in Australia last year. The barbs he has for Ritter are boring enough, but those reserved for his ex are particularly dark. Hopsin leaves no room for interpretation: He uses No Shame (and the press tour promoting it) to get back at the mother of his child, to damage her any way he can: \x93I fuckin\x92 hate this bitch, her name could sit on a grave/Only reason she ain\x92t dead is \x91cause my kid on the way/The bitch is pregnant and she strippin\x92, dodgin\x92 minimum wage/She done kick me down, locked me up, and spit on my face,\x94 he raps, enraged on \x93All Your Fault (Remix).\x94 This is a rapper using the full weight of his musical machine to discredit a woman he pled guilty to assaulting. And even for all his attempts to disgrace and humiliate her, smearing her with slut-shaming tactics and leveraging the entire force of his fan base against her, he still comes off looking much worse. Hopsin takes pride in his writing, making fun of \x93mumble rappers\x94 and those he perceives to be lesser lyricists, but his ideas are always articulated in the most corrosive ways possible; his set-ups and images are awkward, distasteful, and off-putting. Creepiness is an important part of his aesthetic\x97the colored contact lenses, deranged rambler rhyme mechanics (a la Eminem), and so-sinister-they\x92re-campy performances are all tools he uses to paint himself as a rap iconoclast. But even he pushes the limits of likability on No Shame. Slim Shady is his patron saint, and \x93Rap God\x94 is his scripture. All of his defining principles originate there, only executed without grace or guile. Even his horrible, vitriolic anti-ex tirades are cribbed right from the \x93Kim\x94 playbook.  Rage isn\x92t a substitute for artistry. He\x92ll rap nonsense for the sake of the scheme (\x94Napalm in my dang palm/I\x92m a dark villain like Blade, Spawn, or Akon with a cape on\x94). His scenes are insipid. His phrasings are either basic and unsophisticated or simply unnatural, playing up the phonetics as a distraction. \x93Evil and purgin\x92, I am more deceiving in person/Screamin\x92 and cursin\x92, fuck the world with penis insertions/I\x92ma feel this way until the day I\x92m leavin\x92 this Earth, man,\x94 he raps on \x93Witch Doctor.\x94 You can almost hear him asking himself, \x93what rhymes with this?\x94 making raps purposelessly denser with complete disregard for syntax. The songs that aren\x92t vehicles for his hatred are pointless exercises, each an elaborate convolution. Most Hopsin verses are assembled the same way, with choppy, rapid-fire cadences of multisyllabic filler. Every diphthong and accent ricochets off the next, creating the illusion of mastery when really, it\x92s less complex than letting an algorithm generate raps from scratch. There\x92s no value in craftsmanship alone; there has to be flow, direction, and meaning. \x93Rap monster, Black Mamba/You can\x92t run from the wrath I\x92ve been asked to cast on ya/To all the haters who been keepin\x92 up with my every move/Here\x92s my penis to latch on/I\x92m the only MC in this wack genre,\x94 he raps, following his technicality-first formula. And if there was any doubt that he\x92s detrimentally a creature of habit, he\x92s now nine songs deep in an \x93Ill Mind of Hopsin\x94 series that ran out of ideas four songs ago. Things get even more unpleasant when Hopsin takes detours. On \x93Happy Ending,\x94 he raps about getting off at a massage parlor in a terrible mock accent, mimicking the masseuse for the hook: \x93If you no say nothing, I can give you sucky-sucky.\x94 It would be one thing if the song was just crude or offensive or unlistenable, but it\x92s a trifecta. There aren\x92t any moments of remorse or thoughtfulness on No Shame, but there are a few moments of reflection. \x93I don\x92t like Marcus, I don\x92t like Hopsin/I am ashamed of them both,\x94 he raps on \x93Marcus\x92 Gospel\x94 before concluding, \x93I made my bed, I\x92ma lay in it.\x94 These bars would have you believe Hopsin has learned from his mistakes. But No Shame proves otherwise. The album rebukes any and all responsibility for his current predicament, shifting blame onto others. And in an attempt to weaponize his raps against his adversaries, he exposes his deepest flaws. His album is a reminder that shame is a productive and even necessary thing, keeping us from further making fools of ourselves.',
        3.5],
       ['Material Control', 'Glassjaw', 0, ..., 'Rock',
        'On their first album in 15 years, the Long Island post-hardcore band Glassjaw picks up right where they left off. But their heaviest material yet is, at times, lacking in dynamics and atmosphere. Material Control wouldn\x92t exist if Daryl Palumbo didn\x92t believe it was \x93the most Glassjaw-sounding music we could be making at this point.\x94 There is no doubting the purity of their vision, as lead single \x93New White Extremity\x94 is Glassjaw as hell. Its aggression and abrasive, abstract skronk tie together New York hardcore and no wave, mixed with astringent third-wave emo melody and the CGI\x92d musculature of nu-metal production\x97all with Palumbo doing his ocean-sized roar over it all like Long Island\x92s answer to Perry Farrell. In 2015, the band released \x93New White Extremity\x94 as a one-off, assumed to lead up to this very moment, where it serves as the opener for the first Glassjaw album in 15 years. If there was any doubt whether Glassjaw can pick up where they left off, Material Control answers it as immediately and literally as possible. Whether or not they were doubted, Glassjaw were going to act as if they were. They\x92re a band that\x92s thrived in a state of constant conflict. Fan favorites from their 2000 debut Everything You Ever Wanted to Know About Silence include \x93Pretty Lush\x94 and \x93Ry-Ry\x92s Song,\x94 chief exhibits among the evidence of their scene\x92s ingrained misogyny. These were scorched-earth responses to romantic betrayal performed with such energy that they sound like an endorsement. With their 2002 album Worship and Tribute, Glassjaw were positioned as post-hardcore\x92s Next Big Thing, forged under the pressure of Warner Bros. execs, the Twin Towers of nu-metal (producer Ross Robinson, mixer Chris Lord-Alge), and the band\x92s own outsized ambitions. It didn\x92t have the impact of, say, Relationship of Command, but like At the Drive In, Glassjaw followed their frenzied, fraught breakthrough by taking the next decade off. While creating Material Control, multi-instrumentalist Justin Beck (he and Palumbo constitute the core of Glassjaw) asked a rhetorical question: \x93Yo, if we were 14 again and recording with Martin Bisi and could just be the illest, grimiest band in New York, what would the environment be like?\x94 This is a smart approach, especially in the wake of recent albums from post-hardcore greats like At the Drive In, Refused, and Quicksand. Think of the fan who found those other albums to be hella soft, who wrongly assumed that Palumbo would remain too committed to the pop ambitions of his regrettably-named electronica outfits Head Automatica and Colour Film\x97Material Control is for that person. Material Control certainly can lay claim to being Glassjaw\x92s heaviest or most aggro album. And though most of Palumbo\x92s lyrics are too circumspect to get much across beyond their titles (\x93My Conscience Weighs a Ton,\x94 \x93Bibleland 6\x94), he says it\x92s political in a \x93George Carlin way.\x94 \x93New White Extremity\x94 surveys the demographics of a new Brooklyn, which Beck describes as \x93white people from Kansas.\x94 Despite their multimedia affinity for gruff, hardscrabble NYC cynicism, Material Control lives in the now, one of constant physical and mental confrontation and claustrophobia. Like their hardcore heroes, Glassjaw want you to feel the experience of getting constantly elbowed on the street and the subway, only now it also happens while staring at an iPhone and getting constantly prodded by bad opinions. Nearly every second of Material Control is meant to duplicate this sensory overload. Beck, in particular, puts forth a performance of remarkable endurance and dexterity, neck-snap riffs constantly battling his textural playing in the right channel, intended as field recordings from the concrete jungle\x97circular saws meeting sheet metal, the blare of car horns, jammed traffic. Without Dillinger Escape Plan to use as an outlet anymore, drummer Billy Rymer pushes his new band to their most feral extremes, shuttling from groove-metal, d-beat insanity, free-form dub, and tabla-spiked drone in consecutive tracks. But Glassjaw are so intent on proving they can still Glassjaw that they leave no space to build, to create dynamics or generate atmosphere. They really leave no space for Palumbo, and while there are distinct choruses, there are no hooks. There are more memorable basslines than vocal melodies. If Glassjaw was expected to top their forebears like Orange 9mm and Mind Over Matter as a commercial proposition, though, it was due to Palumbo\x97a \x93Jeff Buckley-in-hell post-hardcore,\x94 an unusually magnetic presence for this grotty realm. But he can\x92t work within these arrangements so much as over or under them. Palumbo elongates vowels while improvising pitch and hoping for the best. Elsewhere, he\x92s almost completely submerged in a mix created without nuance or mercy. If you can withstand the initial onslaught of Material Control, it can be plucked for stems: the cooed harmonies on \x93Shira,\x94 the warm bass countermelodies from \x93Golgotha,\x94 any of the individual elements of \x93Pretty Hell.\x94 The latter serves as the kind of U-turn into amniotic balladry that has sustained the midsections of Deftones albums for the past 20 years. Despite its studied dub production, \x93Pretty Hell\x94 is a mess that wastes the strongest chorus on an arrangement where no instrument appears to be aware of the other\x92s existence. There are points where Glassjaw can work towards a satisfying payoff rather than going all in at once, like the raga experiment \x93Bastille Day\x94 and the title track, which both aspire to the symphonic grandeur of major-label Trail of Dead. To Palumbo\x92s credit, he recognizes the potency of being that angry, impulsive 14-year-old hardcore kid\x97though he\x92s now channeling his adolescent rage towards more worthy targets. On an immediate level, Material Control is a record that simply feels good to have, specifically at the end of 2017\x97a time when everyone\x92s coming together to praise the year\x92s most agreeable rock records, when every day brings further proof that the arc of the moral universe has gone way the fuck off course, when you just want to scream into the void. Think of Material Control as a post-hardcore Long Island tea: it\x92ll take you back to being a teen when you could care less what was in it and how it was mixed together. The only thing that mattered was whether you got knocked on your ass.',
        6.6],
       ...,
       ['Singles Breaking Up, Vol. 1', 'Don Caballero', 0, ...,
        'Experimental',
        'Well, kids, I just went back and re-read my review for these guys\' last album, What Burns never Returns, and what a laugh it was! Sometimes I just love to pretend to be a record reviewer! In my last review, I stated that Don Caballero was "creating cohesive songs from the cacaphony of frenetically beaten drums." Yeah, right! More like creating a goopy mess of my brain between my ears. Well, here I find myself, living a Dilbert- like existence, not even given the dignity of a cubicle, forced to isolate myself the only way I know how: headphones filled with grunchy, mean toonz. Sure, sometimes I listen to porn MPEGs or NPR\'s This American Life, but when I\'m given a particularly enervating task-- something like, say, stapling-- I like to put my head between the hairy thighs of Don Caballero. Sure, it smells a little funky down there, and all\'s I can hear is the pounding of drums upon my skull, but I like it. I see it as an expression against the machine of oppression, man! Yeah, oppression... Don C., in case you\'ve been too lazy to go back and read the earlier review, is intense, indie jam-rok of the highest order. Perhaps you\'ve got friends that like to noodle around with offbeat guitar themes and love to hammer their drum sets without mercy. Perhaps they drink malt liquor and smell like clove cigarettes. Perhaps they stick sharp, barbed objects into their bottoms. Perhaps you have a very vague idea of what we\'re talking about here: jamming. Stinky, sore- bottomed jamming. Inspired, sore- bottomed jamming. Wikked, sharp, tight, sore- bottomed jamming. No lyrics, no mandolin, no techno beats or phat rhymes, just pure, glorious, sore- bottomed jamming. Thank You Jesus! So, Singles Breaking Up (Vol 1) collects the band\'s EP and compilation releases into one, easy- to- use compact disc. Convenient, and perfect for the on- the- go individual, Singles has the texture you\'d expect from such a collection-- lacking the overall continuity that What Burns Never Returns possessed, it serves to chronicle their progress since 1992, before they even released their first album, 1993\'s For Respect. Since this stuff is clearly marketed to instrumento-geeks and weirdos, I would suggest you take a large dose of Ketamine before enjoying. And don\'t forget to stick a sharp, barbed object into your bottom!',
        7.2],
       ['Out of Tune', 'Mojave 3', 0, ..., 'Rock',
        'Out of Tune is a Steve Martin album. Yes, I\'ll explain: \\n\\n\\ Once upon a time, there was ... Out of Tune is a Steve Martin album. Yes, I\'ll explain: Once upon a time, there was Steve Martin, a man with a plan to make us all laugh. His preferred method of inducing laughter was absurdity, doing his "Ramblin\' Man" thang for a while before finally finding a shortcut called "Excuuuuuuse me!" You kids these days may not know it, but if you said those two words just right, the whole wide world of 1976 was on their knees, suffocating with laughter. Continuing his domination by laughter, Martin did a few movies, most notably "The Jerk," one of the finest feature films of all time. Public opinion on "Just how funny is this Steve Martin guy, anyhow?" took a downslide once the \'80s began. His movies remained true to his desire to be Mr. Absurd ("The Man With Two Brains" probably being the apex of the truly hilarious/ nobody cares period), until finally he began to shift gears... crashing head on into a 1986 mess called "The Three Amigos." A horrible, unfunny film, Martin nonetheless recovered just a year later with "Roxanne" and one of his finest works, "Planes Trains and Automobiles." Do you see where I\'m going with this? Oh, wait. I haven\'t even gotten there. Martin went right into the toilet shortly thereafter, trying to first become more sitcom- friendly ("Houseguest"), then semi- dramatic ("Leap of Faith"), until he released a movie that nobody went to see called "A Simple Twist of Fate." Released in 1993, this was a seriously tragic and poorly- done flick about a man and his pet orphan who, if you can imagine, becomes the focus of a nasty custody dispute. When I first heard about this "Fate" bullshit, I thought it was a joke. Catching a few minutes of it a couple of weeks back, I was stunned. Here was a man who used to be in sync with that white noise comedy Robin Williams also excelled at. And, by the way, look at the unfortunate high grosses for "Patch Adams." Williams can at least laugh all the way to the bank with his betrayal of funny. Martin had to flop yet again with "The Out of Towners," but not before he did the also not- too- funny "Sgt. Bilko." Oh, yeah. Mojave 3. Three of these kids used to be in a band called Slowdive. Slowdive was to shoegazing what Steve Martin was to funny circa 1979. Slowdive wasn\'t more complex than their notorious peers, My Bloody Valentine, and they weren\'t as drunk as Ride, but they sure did make some purdy rekkids. Of course, they had to eventually blow off what they were good at to make their own "Simple Twist of Fate," an unfortunate album called Ask Me Tomorrow. And in their desire to be taken seriously, they cast off what made \'em so goddamned good in the first place. Out of Tune isn\'t a step back into Slowdive mode, but it is a much more winsome affair than Tomorrow. I had more hopes just based on the cover alone. (If there are any of those giant Eurpoean subway posters for this floating around, I have a wall in dire need of beauty.) Neil Halstead and Rachel Goswell sing a little differently than back in the day, going aurally naked (sans a zillion effects) and stepping out into the SoCal pot- happy sunshine folk- rock thing they\'re doing now. No, it doesn\'t sound like the Eagles, but a few cuts remind me of that godawful shit Ethan Hawke got to sing. Okay, not really, but somewhere Ethan Hawke is just popping a boner because someone mentioned his name in the press again. So, what do I think overall? It\'s not as meaty as it could be. Whereas Slowdive\'s lyrics were more enigmatic (or maybe appeared to be through a fog of tremelo), Mojave 3 goes for those bold statements that annoy me. Check these songs titles: "Who Do You Love" (no, not that one), "Some Kinda Angel" (where Goswell conjures up some Stevie Nicks mojo), "All Your Tears," "Baby\'s Coming Home..." you get the idea. Lots of acoustic guitars, organ, some pedal steel, and harmonies make this a pleasant enough sort of listen as long as I take a bong hit and stare at the cover. Or, to boil it all down into one sentence, this could very well be the first 4AD album to be fully embraced by both AAA radio stations and your mom. File it somewhere between "Housesitter" and "Father of the Bride." Post Review Note: I just got back from Cellophane Square music store on University Avenue in Seattle, and I guess I should mention that, according to a Mojave 3 display, a clerk named Karrie really digs the songs "Caught Beneath Your Feet" and "This Road I\'m Traveling." I\'m not doing this to hit on her-- I didn\'t ask for Karrie and for all I know she\'s an ugg-o-- but if you\'re a rabid Mojave 3 fan who doesn\'t like what I have to say, take Karrie\'s endorsement to heart.',
        6.3],
       ['Left for Dead in Malaysia', 'Neil Hamburger', 0, ..., 'None',
        'Neil Hamburger\'s third comedy release is a desperate affair, even for a sad sack such as America\'s Funnyman ... Neil Hamburger\'s third comedy release is a desperate affair, even for a sad sack such as America\'s Funnyman. Hamburger-- aka Gregg Turkington-- takes his routine to Kuala Lumpur, Malaysia, warming up the locals before karaoke time. Too bad nobody in the audience speaks or understands English. It\'s a broad setup knocked down with Hamburger\'s usual patheticness. (Sample joke: "How many Spice Girls does it take to screw in a lightbulb? Well, it was five, now it\'s four, and I\'m sure any day now it\'ll be down to three. Uh, huhhhh...") Early on in the show, Hamburger realizes no one in the crowd speaks English and, worse yet, his manager and right- hand man Art Huckman flees the scene in a huff. With no one left to lean on, Neil opens up about his past gigs performing at Amway conventions, his failed marriage, and a little something called "Montezuma\'s Revenge." Is it funny? Not really, but that\'s the point. Left for Dead in Malaysia is forty minutes of flop sweats, so much so that you might feel moist after listening. As usual, the joke is on Hamburger; is there a bigger loser on the planet than this guy? Yes, but the flat routine on Left for Dead may have you thinking otherwise. Hamburger (or Turkington, to be more precise) hits the desperation nail square on the head, but Raw Hamburger and America\'s Funnyman both fared a lot better. I\'m sure that there\'s going to be another Neil Hamburger album-- the stage is easily set for this loser to sink even lower-- and those who enjoyed the previous albums will enjoy Left for Dead more than the folks who don\'t get the joke. But there aren\'t really any jokes on this album, just a series of empty shells and failed observations... classic Hamburger.',
        6.5]], dtype=object)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># sorting on current index
</span><span class="n">p4k</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>1999</td>
      <td>Cassius</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>1999-01-05</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 7 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'album'</span><span class="p">)</span> <span class="c1"># set the data frame index using existing columns
# Note: index can be reset to default using reset_index()
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
    </tr>
    <tr>
      <th>album</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A.M./Being There</th>
      <td>Wilco</td>
      <td>1</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>No Shame</th>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Material Control</th>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>Weighing of the Heart</th>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>The Visitor</th>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1999</th>
      <td>Cassius</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>Let Us Replay!</th>
      <td>Coldcut</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>Singles Breaking Up, Vol. 1</th>
      <td>Don Caballero</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>Out of Tune</th>
      <td>Mojave 3</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>Left for Dead in Malaysia</th>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>1999-01-05</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 6 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># multi-indexes can be set with set_index()
</span><span class="n">multindexP4k</span> <span class="o">=</span> <span class="n">p4k</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s">'genre'</span><span class="p">,</span><span class="s">'date'</span><span class="p">])</span>
<span class="n">multindexP4k</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>review</th>
      <th>score</th>
    </tr>
    <tr>
      <th>genre</th>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Rock</th>
      <th>2017-12-06</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>Rap</th>
      <th>2017-12-06</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Rock</th>
      <th>2017-12-06</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>Pop/R&amp;B</th>
      <th>2017-12-06</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>Rock</th>
      <th>2017-12-05</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">multindexP4k</span><span class="o">.</span><span class="n">index</span>
<span class="c1"># multindexP4k.index[0] # selecting first row from multi-index
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MultiIndex([(        'Rock', '2017-12-06'),
            (         'Rap', '2017-12-06'),
            (        'Rock', '2017-12-06'),
            (     'Pop/R&amp;B', '2017-12-06'),
            (        'Rock', '2017-12-05'),
            (     'Pop/R&amp;B', '2017-12-05'),
            (     'Pop/R&amp;B', '2017-12-05'),
            (         'Rap', '2017-12-05'),
            (        'Rock', '2017-12-04'),
            (       'Metal', '2017-12-04'),
            ...
            (  'Electronic', '1999-02-11'),
            (  'Electronic', '1999-02-09'),
            (  'Electronic', '1999-02-09'),
            ('Folk/Country', '1999-02-09'),
            (  'Electronic', '1999-02-01'),
            (  'Electronic', '1999-01-26'),
            (  'Electronic', '1999-01-26'),
            ('Experimental', '1999-01-12'),
            (        'Rock', '1999-01-12'),
            (        'None', '1999-01-05')],
           names=['genre', 'date'], length=19555)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">multindexP4k</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['Rock', 'Rap', 'Rock', 'Pop/R&amp;B', 'Rock', 'Pop/R&amp;B', 'Pop/R&amp;B', 'Rap',
       'Rock', 'Metal',
       ...
       'Electronic', 'Electronic', 'Electronic', 'Folk/Country', 'Electronic',
       'Electronic', 'Electronic', 'Experimental', 'Rock', 'None'],
      dtype='object', name='genre', length=19555)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">multindexP4k</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DatetimeIndex(['2017-12-06', '2017-12-06', '2017-12-06', '2017-12-06',
               '2017-12-05', '2017-12-05', '2017-12-05', '2017-12-05',
               '2017-12-04', '2017-12-04',
               ...
               '1999-02-11', '1999-02-09', '1999-02-09', '1999-02-09',
               '1999-02-01', '1999-01-26', '1999-01-26', '1999-01-12',
               '1999-01-12', '1999-01-05'],
              dtype='datetime64[ns]', name='date', length=19555, freq=None)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">multindexP4k</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">()</span> <span class="c1"># Swapping levels
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>review</th>
      <th>score</th>
    </tr>
    <tr>
      <th>date</th>
      <th>genre</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">2017-12-06</th>
      <th>Rock</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>Rap</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Rock</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>Pop/R&amp;B</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>2017-12-05</th>
      <th>Rock</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1999-01-26</th>
      <th>Electronic</th>
      <td>1999</td>
      <td>Cassius</td>
      <td>0</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>Electronic</th>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1999-01-12</th>
      <th>Experimental</th>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>Rock</th>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>1999-01-05</th>
      <th>None</th>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 5 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Extract Rows from a MultiIndex Dataframe
# multindexP4k.loc[("2017-12-05","Rock")]
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">multindexP4k</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>review</th>
      <th>score</th>
    </tr>
    <tr>
      <th>genre</th>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Rock</th>
      <th>2017-12-06</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>Rap</th>
      <th>2017-12-06</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Rock</th>
      <th>2017-12-06</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>Pop/R&amp;B</th>
      <th>2017-12-06</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>Rock</th>
      <th>2017-12-05</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Electronic</th>
      <th>1999-01-26</th>
      <td>1999</td>
      <td>Cassius</td>
      <td>0</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>1999-01-26</th>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>Experimental</th>
      <th>1999-01-12</th>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>Rock</th>
      <th>1999-01-12</th>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>None</th>
      <th>1999-01-05</th>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 5 columns</p>
</div>

<p>When working with multiple indexes, the <strong>.stack()</strong> and <strong>unstack()</strong> methods can help gather or spread the data</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">multindexP4k</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span> <span class="c1"># gathers all the column data into a new index with one columns holding all the values
</span><span class="n">multindexP4k</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span> <span class="c1"># Converting to a dataframe
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>genre  date              
Rock   2017-12-06  album                                      A.M./Being There
                   artist                                                Wilco
                   best                                                      1
                   review    Best new reissue 1 / 2 Albums Newly reissued a...
                   score                                                     7
                                                   ...                        
None   1999-01-05  album                             Left for Dead in Malaysia
                   artist                                       Neil Hamburger
                   best                                                      0
                   review    Neil Hamburger's third comedy release is a des...
                   score                                                   6.5
Length: 97769, dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">multindexP4k</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MultiIndex([('Rock', '2017-12-06',  'album'),
            ('Rock', '2017-12-06', 'artist'),
            ('Rock', '2017-12-06',   'best'),
            ('Rock', '2017-12-06', 'review'),
            ('Rock', '2017-12-06',  'score'),
            ( 'Rap', '2017-12-06',  'album'),
            ( 'Rap', '2017-12-06', 'artist'),
            ( 'Rap', '2017-12-06',   'best'),
            ( 'Rap', '2017-12-06', 'review'),
            ( 'Rap', '2017-12-06',  'score'),
            ...
            ('Rock', '1999-01-12',  'album'),
            ('Rock', '1999-01-12', 'artist'),
            ('Rock', '1999-01-12',   'best'),
            ('Rock', '1999-01-12', 'review'),
            ('Rock', '1999-01-12',  'score'),
            ('None', '1999-01-05',  'album'),
            ('None', '1999-01-05', 'artist'),
            ('None', '1999-01-05',   'best'),
            ('None', '1999-01-05', 'review'),
            ('None', '1999-01-05',  'score')],
           names=['genre', 'date', None], length=97769)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Unstack does the opposite, spreads the stacked data into multiple columns
</span><span class="n">s</span> <span class="o">=</span> <span class="n">multindexP4k</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="c1"># s.unstack() by default works with the deepest layer. Throws an error on this data as there are duplicates entries
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--------------------------------------------------------------------------

ValueError                               Traceback (most recent call last)

&lt;ipython-input-119-f95cb0e6bf0e&gt; in &lt;module&gt;
      1 # Unstack does the opposite, spreads the stacked data into multiple columns
      2 s = multindexP4k.stack()
----&gt; 3 s.unstack()


~/anaconda3/lib/python3.7/site-packages/pandas/core/series.py in unstack(self, level, fill_value)
   3548         from pandas.core.reshape.reshape import unstack
   3549
-&gt; 3550         return unstack(self, level, fill_value)
   3551
   3552     # ----------------------------------------------------------------------


~/anaconda3/lib/python3.7/site-packages/pandas/core/reshape/reshape.py in unstack(obj, level, fill_value)
    417             level=level,
    418             fill_value=fill_value,
--&gt; 419             constructor=obj._constructor_expanddim,
    420         )
    421         return unstacker.get_result()


~/anaconda3/lib/python3.7/site-packages/pandas/core/reshape/reshape.py in __init__(self, values, index, level, value_columns, fill_value, constructor)
    139
    140         self._make_sorted_values_labels()
--&gt; 141         self._make_selectors()
    142
    143     def _make_sorted_values_labels(self):


~/anaconda3/lib/python3.7/site-packages/pandas/core/reshape/reshape.py in _make_selectors(self)
    177
    178         if mask.sum() &lt; len(self.index):
--&gt; 179             raise ValueError("Index contains duplicate entries, cannot reshape")
    180
    181         self.group_index = comp_index


ValueError: Index contains duplicate entries, cannot reshape
</code></pre></div></div>

<h2 id="9-renaming-labels-and-columns">9. Renaming Labels and Columns</h2>

<p><em>key methods: .rename()</em></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Renaming columns with a dictionary. This method can rename all or some columns
</span><span class="n">p4k</span><span class="o">.</span><span class="n">columns</span>
<span class="n">p4k</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s">"Parent Company"</span> <span class="p">:</span> <span class="s">"parent_company"</span><span class="p">,</span>
                      <span class="s">"album"</span> <span class="p">:</span> <span class="s">"album_title"</span><span class="p">,</span>
                      <span class="s">"artist"</span> <span class="p">:</span> <span class="s">"artist_name"</span><span class="p">,</span>
                      <span class="s">"best"</span> <span class="p">:</span> <span class="s">"best_reviewed"</span><span class="p">,</span>
                      <span class="s">"date"</span> <span class="p">:</span> <span class="s">"review_date"</span><span class="p">,</span>
                      <span class="s">"genre"</span> <span class="p">:</span> <span class="s">"genre_type"</span><span class="p">,</span>
                      <span class="s">"review"</span> <span class="p">:</span> <span class="s">"review_text"</span><span class="p">,</span>
                      <span class="s">"score"</span> <span class="p">:</span> <span class="s">"review_score"</span><span class="p">,</span>
                      <span class="s">"Review Language"</span> <span class="p">:</span> <span class="s">"review_lang"</span><span class="p">,</span>
                      <span class="s">"score_rank"</span> <span class="p">:</span> <span class="s">"ranked_score"</span><span class="p">}</span>
                       <span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>parent_company</th>
      <th>album_title</th>
      <th>artist_name</th>
      <th>best_reviewed</th>
      <th>review_date</th>
      <th>genre_type</th>
      <th>review_text</th>
      <th>review_score</th>
      <th>review_lang</th>
      <th>ranked_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vox</td>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1.0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
      <td>11104.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
      <td>19131.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Vox</td>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>ENG</td>
      <td>13879.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vox</td>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
      <td>5691.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vox</td>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0.0</td>
      <td>December 5 2017</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
      <td>13370.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>Vox</td>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0.0</td>
      <td>January 26 1999</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
      <td>ENG</td>
      <td>587.0</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Vox</td>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>ENG</td>
      <td>9807.0</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Vox</td>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>ENG</td>
      <td>15110.0</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Vox</td>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0.0</td>
      <td>January 5 1999</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>ENG</td>
      <td>14246.0</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>19556 rows × 10 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># This method requires renaming ALL columns
# p4k.columns = ["c1","c2","c3","c4","c5","c6","c7","c8","c9","c10"]
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="p">{</span><span class="s">'1'</span> <span class="p">:</span> <span class="s">'One'</span><span class="p">,</span>
                    <span class="s">'2'</span> <span class="p">:</span> <span class="s">'Two'</span><span class="p">})</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vox</td>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1.0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>ENG</td>
      <td>11104.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Vox</td>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>ENG</td>
      <td>19131.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Vox</td>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>ENG</td>
      <td>13879.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Vox</td>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0.0</td>
      <td>December 6 2017</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>ENG</td>
      <td>5691.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Vox</td>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0.0</td>
      <td>December 5 2017</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>ENG</td>
      <td>13370.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>Vox</td>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0.0</td>
      <td>January 26 1999</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
      <td>ENG</td>
      <td>587.0</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Vox</td>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>ENG</td>
      <td>9807.0</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Vox</td>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0.0</td>
      <td>January 12 1999</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>ENG</td>
      <td>15110.0</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Vox</td>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0.0</td>
      <td>January 5 1999</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>ENG</td>
      <td>14246.0</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>19556 rows × 10 columns</p>
</div>

<h2 id="10-sampling">10. Sampling</h2>

<p><em>key methods: .sample()</em></p>

<p>A random sample of either an integer count or a fraction of the total can be done through <strong>.sample()</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">p4k</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Parent Company</th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>Review Language</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>18004</th>
      <td>Vox</td>
      <td>Dirty Vegas</td>
      <td>Dirty Vegas</td>
      <td>0.0</td>
      <td>July 8 2002</td>
      <td>Electronic</td>
      <td>Used to be, way back in the twentieth century,...</td>
      <td>4.4</td>
      <td>ENG</td>
      <td>18683.0</td>
    </tr>
    <tr>
      <th>9255</th>
      <td>Vox</td>
      <td>The Creatures in the Garden of Lady Walton / V...</td>
      <td>Clogs</td>
      <td>0.0</td>
      <td>March 3 2010</td>
      <td>Rock</td>
      <td>1 / 2 Albums The National's Bryce Dessner's po...</td>
      <td>8.2</td>
      <td>ENG</td>
      <td>2308.0</td>
    </tr>
    <tr>
      <th>7502</th>
      <td>Vox</td>
      <td>I Am an Attic</td>
      <td>Nick Diamonds</td>
      <td>0.0</td>
      <td>August 26 2011</td>
      <td>Rock</td>
      <td>The busy collaborator and frontman (Mister Hea...</td>
      <td>6.4</td>
      <td>ENG</td>
      <td>14728.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># By default rows are sampled, but columns can be sampled as well
</span><span class="n">p4k</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p4k</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="s">"columns"</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>review</th>
      <th>score_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>11104.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>19131.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>13879.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>5691.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>13370.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>The marketing guys of yer average modern megac...</td>
      <td>587.0</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>9807.0</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>15110.0</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>14246.0</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>19556 rows × 2 columns</p>
</div>

<h2 id="11-grouping-and-agg">11. Grouping and Agg</h2>

<p><em>key methods: .groupby(), .agg()</em></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'genre'</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>genre
Electronic      4020
Experimental    1699
Folk/Country     700
Global           178
Jazz             257
Metal            781
None            2324
Pop/R&amp;B         1157
Rap             1481
Rock            6958
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'genre'</span><span class="p">,</span><span class="s">'best'</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>genre         best
Electronic    0       3827
              1        193
Experimental  0       1588
              1        111
Folk/Country  0        667
              1         33
Global        0        169
              1          9
Jazz          0        232
              1         25
Metal         0        759
              1         22
None          0       2269
              1         55
Pop/R&amp;B       0       1070
              1         87
Rap           0       1399
              1         82
Rock          0       6535
              1        423
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">genre_group</span> <span class="o">=</span> <span class="n">p4k</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'genre'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">genre_group</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span> <span class="c1"># by default, will only apply to numeric columns
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best</th>
      <th>score</th>
    </tr>
    <tr>
      <th>genre</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Electronic</th>
      <td>193</td>
      <td>27904.1</td>
    </tr>
    <tr>
      <th>Experimental</th>
      <td>111</td>
      <td>12503.0</td>
    </tr>
    <tr>
      <th>Folk/Country</th>
      <td>33</td>
      <td>5053.9</td>
    </tr>
    <tr>
      <th>Global</th>
      <td>9</td>
      <td>1323.4</td>
    </tr>
    <tr>
      <th>Jazz</th>
      <td>25</td>
      <td>1945.1</td>
    </tr>
    <tr>
      <th>Metal</th>
      <td>22</td>
      <td>5451.7</td>
    </tr>
    <tr>
      <th>None</th>
      <td>55</td>
      <td>16315.9</td>
    </tr>
    <tr>
      <th>Pop/R&amp;B</th>
      <td>87</td>
      <td>8039.2</td>
    </tr>
    <tr>
      <th>Rap</th>
      <td>82</td>
      <td>10293.4</td>
    </tr>
    <tr>
      <th>Rock</th>
      <td>423</td>
      <td>48592.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">genre_group</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="c1"># standard deviation of scores by group
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>genre
Electronic      1.286230
Experimental    1.084305
Folk/Country    1.039006
Global          1.020147
Jazz            1.160742
Metal           1.382885
None            1.232897
Pop/R&amp;B         1.251231
Rap             1.259559
Rock            1.336472
Name: score, dtype: float64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">genre_group</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> <span class="c1"># Describe
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>genre</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Electronic</th>
      <td>4020.0</td>
      <td>6.941318</td>
      <td>1.286230</td>
      <td>0.2</td>
      <td>6.4</td>
      <td>7.2</td>
      <td>7.8</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Experimental</th>
      <td>1699.0</td>
      <td>7.359035</td>
      <td>1.084305</td>
      <td>0.3</td>
      <td>6.9</td>
      <td>7.5</td>
      <td>8.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Folk/Country</th>
      <td>700.0</td>
      <td>7.219857</td>
      <td>1.039006</td>
      <td>2.3</td>
      <td>6.8</td>
      <td>7.4</td>
      <td>7.9</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Global</th>
      <td>178.0</td>
      <td>7.434831</td>
      <td>1.020147</td>
      <td>2.2</td>
      <td>7.1</td>
      <td>7.7</td>
      <td>8.0</td>
      <td>9.4</td>
    </tr>
    <tr>
      <th>Jazz</th>
      <td>257.0</td>
      <td>7.568482</td>
      <td>1.160742</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>7.7</td>
      <td>8.2</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Metal</th>
      <td>781.0</td>
      <td>6.980410</td>
      <td>1.382885</td>
      <td>0.2</td>
      <td>6.5</td>
      <td>7.4</td>
      <td>7.9</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>None</th>
      <td>2324.0</td>
      <td>7.020611</td>
      <td>1.232897</td>
      <td>0.0</td>
      <td>6.5</td>
      <td>7.2</td>
      <td>7.8</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Pop/R&amp;B</th>
      <td>1157.0</td>
      <td>6.948315</td>
      <td>1.251231</td>
      <td>0.0</td>
      <td>6.3</td>
      <td>7.1</td>
      <td>7.7</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Rap</th>
      <td>1481.0</td>
      <td>6.950304</td>
      <td>1.259559</td>
      <td>1.0</td>
      <td>6.4</td>
      <td>7.2</td>
      <td>7.8</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Rock</th>
      <td>6958.0</td>
      <td>6.983616</td>
      <td>1.336472</td>
      <td>0.0</td>
      <td>6.4</td>
      <td>7.2</td>
      <td>7.8</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">best_genre</span> <span class="o">=</span> <span class="n">p4k</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'genre'</span><span class="p">,</span><span class="s">'best'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># returning most recent best=1 reviews by genre
</span><span class="n">best_genre</span><span class="p">[</span><span class="s">'date'</span><span class="p">]</span><span class="o">.</span><span class="nb">max</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>genre         best
Electronic    0      2017-11-30
              1      2017-11-27
Experimental  0      2017-11-30
              1      2017-10-04
Folk/Country  0      2017-11-29
              1      2017-08-11
Global        0      2017-09-29
              1      2017-10-04
Jazz          0      2017-11-29
              1      2017-11-10
Metal         0      2017-12-04
              1      2017-12-02
None          0      2017-12-01
              1      2017-10-25
Pop/R&amp;B       0      2017-12-06
              1      2017-12-05
Rap           0      2017-12-06
              1      2017-10-07
Rock          0      2017-12-06
              1      2017-12-06
Name: date, dtype: datetime64[ns]
</code></pre></div></div>

<p>Aggregate - aggregate data using one or more operations over the specified axis.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">genre_group</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s">"best"</span> <span class="p">:</span> <span class="s">"sum"</span><span class="p">,</span>
             <span class="s">"score"</span> <span class="p">:</span> <span class="s">"mean"</span><span class="p">,</span>
             <span class="s">"date"</span><span class="p">:</span> <span class="s">"min"</span><span class="p">})</span> <span class="c1"># can specify methods by columns using a python dictionary
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>best</th>
      <th>score</th>
      <th>date</th>
    </tr>
    <tr>
      <th>genre</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Electronic</th>
      <td>193</td>
      <td>6.941318</td>
      <td>1999-01-26</td>
    </tr>
    <tr>
      <th>Experimental</th>
      <td>111</td>
      <td>7.359035</td>
      <td>1999-01-12</td>
    </tr>
    <tr>
      <th>Folk/Country</th>
      <td>33</td>
      <td>7.219857</td>
      <td>1999-02-09</td>
    </tr>
    <tr>
      <th>Global</th>
      <td>9</td>
      <td>7.434831</td>
      <td>1999-06-01</td>
    </tr>
    <tr>
      <th>Jazz</th>
      <td>25</td>
      <td>7.568482</td>
      <td>1999-06-08</td>
    </tr>
    <tr>
      <th>Metal</th>
      <td>22</td>
      <td>6.980410</td>
      <td>1999-02-16</td>
    </tr>
    <tr>
      <th>None</th>
      <td>55</td>
      <td>7.020611</td>
      <td>1999-01-05</td>
    </tr>
    <tr>
      <th>Pop/R&amp;B</th>
      <td>87</td>
      <td>6.948315</td>
      <td>1999-02-23</td>
    </tr>
    <tr>
      <th>Rap</th>
      <td>82</td>
      <td>6.950304</td>
      <td>1999-10-12</td>
    </tr>
    <tr>
      <th>Rock</th>
      <td>423</td>
      <td>6.983616</td>
      <td>1999-01-12</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># giving a list instead for multiple methods to each col
</span><span class="n">genre_group</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s">'size'</span><span class="p">,</span><span class="s">'sum'</span><span class="p">,</span><span class="s">'mean'</span><span class="p">])</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">best</th>
      <th colspan="3" halign="left">score</th>
    </tr>
    <tr>
      <th></th>
      <th>size</th>
      <th>sum</th>
      <th>mean</th>
      <th>size</th>
      <th>sum</th>
      <th>mean</th>
    </tr>
    <tr>
      <th>genre</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Electronic</th>
      <td>4020</td>
      <td>193</td>
      <td>0.048010</td>
      <td>4020</td>
      <td>27904.1</td>
      <td>6.941318</td>
    </tr>
    <tr>
      <th>Experimental</th>
      <td>1699</td>
      <td>111</td>
      <td>0.065333</td>
      <td>1699</td>
      <td>12503.0</td>
      <td>7.359035</td>
    </tr>
    <tr>
      <th>Folk/Country</th>
      <td>700</td>
      <td>33</td>
      <td>0.047143</td>
      <td>700</td>
      <td>5053.9</td>
      <td>7.219857</td>
    </tr>
    <tr>
      <th>Global</th>
      <td>178</td>
      <td>9</td>
      <td>0.050562</td>
      <td>178</td>
      <td>1323.4</td>
      <td>7.434831</td>
    </tr>
    <tr>
      <th>Jazz</th>
      <td>257</td>
      <td>25</td>
      <td>0.097276</td>
      <td>257</td>
      <td>1945.1</td>
      <td>7.568482</td>
    </tr>
    <tr>
      <th>Metal</th>
      <td>781</td>
      <td>22</td>
      <td>0.028169</td>
      <td>781</td>
      <td>5451.7</td>
      <td>6.980410</td>
    </tr>
    <tr>
      <th>None</th>
      <td>2324</td>
      <td>55</td>
      <td>0.023666</td>
      <td>2324</td>
      <td>16315.9</td>
      <td>7.020611</td>
    </tr>
    <tr>
      <th>Pop/R&amp;B</th>
      <td>1157</td>
      <td>87</td>
      <td>0.075194</td>
      <td>1157</td>
      <td>8039.2</td>
      <td>6.948315</td>
    </tr>
    <tr>
      <th>Rap</th>
      <td>1481</td>
      <td>82</td>
      <td>0.055368</td>
      <td>1481</td>
      <td>10293.4</td>
      <td>6.950304</td>
    </tr>
    <tr>
      <th>Rock</th>
      <td>6958</td>
      <td>423</td>
      <td>0.060793</td>
      <td>6958</td>
      <td>48592.0</td>
      <td>6.983616</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="12-date-and-times">12. Date and Times</h2>

<p><em>key attributes: .year, .month, .day, .dayofweek, .hour, .minute, .second</em></p>

<p><em>key methods: .Timestamp(), .to_datetime. .date_range(), .truncate(), .dateoffset(), .Timedelta()</em></p>

<p>The following functions for working more closely with dates come both pandas and from the <a href="https://docs.python.org/3/library/datetime.html">datetime</a> library.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="n">dt</span>
</code></pre></div></div>

<p>Creating dates and datetimes</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Creating dates
</span><span class="n">someday</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="n">someday</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>datetime.date(2016, 4, 12)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># extracting date values
</span><span class="n">someday</span><span class="o">.</span><span class="n">year</span>
<span class="n">someday</span><span class="o">.</span><span class="n">month</span>
<span class="n">someday</span><span class="o">.</span><span class="n">day</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>12
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Creating datetimes
</span><span class="n">somedatetime</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">59</span><span class="p">)</span>
<span class="n">somedatetime</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>datetime.datetime(2016, 4, 12, 8, 13, 59)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># extracting date and time values
</span><span class="n">somedatetime</span><span class="o">.</span><span class="n">year</span>
<span class="n">somedatetime</span><span class="o">.</span><span class="n">month</span>
<span class="n">somedatetime</span><span class="o">.</span><span class="n">day</span>
<span class="n">someday</span><span class="o">.</span><span class="n">dayofweek</span>
<span class="n">somedatetime</span><span class="o">.</span><span class="n">hour</span>
<span class="n">somedatetime</span><span class="o">.</span><span class="n">minute</span>
<span class="n">somedatetime</span><span class="o">.</span><span class="n">second</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>59
</code></pre></div></div>

<p>The pandas <strong>.Timestamp()</strong> and <strong>.to_datetime().</strong> method can work with a variety of input formats</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s">'2015-3-31'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s">'2015/3/31'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s">'2015, 3, 31'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Timestamp('2015-03-31 00:00:00')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s">'1/1/2012 08:35:15'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s">'1/1/2012 08:35:15 PM'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Timestamp('2012-01-01 08:35:05')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s">"2001-04-19"</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s">"2015-01-03"</span><span class="p">,</span><span class="s">"2014/02/08"</span><span class="p">,</span><span class="s">"2016"</span><span class="p">,</span><span class="s">"July 4th, 1996"</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">times</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s">"2015-01-03"</span><span class="p">,</span><span class="s">"2014/02/08"</span><span class="p">,</span><span class="s">"2016"</span><span class="p">,</span><span class="s">"July 4th, 1996"</span><span class="p">])</span>
<span class="n">times</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
</code></pre></div></div>

<p>pd.to_datetime can also work with bad data provided the errors are coerced:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bad_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s">"July 14th 1995"</span><span class="p">,</span><span class="s">"Hello"</span><span class="p">,</span><span class="s">"2015-2-31"</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">bad_dates</span><span class="p">)</span>
<span class="c1"># To handle this set errors="coerce" to fix those it cant. Otherwise will be 'NAT', not a time
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">bad_dates</span><span class="p">,</span><span class="n">errors</span><span class="o">=</span><span class="s">"coerce"</span><span class="p">)</span>
</code></pre></div></div>

<p>The method <strong>pd.date_range()</strong> is used to create a range of dates of different frequnecies</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">times</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">"2016-01-01"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s">"2016-01-11"</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s">"D"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">"2016-01-01"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s">"2016-01-11"</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s">"2D"</span><span class="p">)</span> <span class="c1"># 2 day incriment
</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">"2016-01-01"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s">"2016-01-11"</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s">"B"</span><span class="p">)</span> <span class="c1"># B -Just weekdays
</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">"2016-01-01"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s">"2016-01-16"</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s">"W"</span><span class="p">)</span> <span class="c1"># Weeks (starting on sunday)
</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">"2016-01-01"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s">"2016-01-16"</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s">"W-FRI"</span><span class="p">)</span> <span class="c1"># W-Fri start on Friday
</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">"2016-01-01"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s">"2016-01-16"</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s">"H"</span><span class="p">)</span> <span class="c1"># H - Hour
</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">"2016-01-01"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s">"2016-10-16"</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s">"M"</span><span class="p">)</span> <span class="c1"># M - Month end
</span>
<span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">"2012-09-09"</span><span class="p">,</span><span class="n">periods</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s">"D"</span><span class="p">)</span>  <span class="c1">#Periods = # of results
</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">"2012-09-09"</span><span class="p">,</span><span class="n">periods</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s">"W"</span><span class="p">)</span>  <span class="c1">#Periods = # of results
</span></code></pre></div></div>

<p>Date series or columns can be filtered using <strong>.truncate()</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dp4k</span> <span class="o">=</span> <span class="n">p4k</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'date'</span><span class="p">)</span>
<span class="n">dp4k</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-12-06</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2017-12-06</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>2017-12-06</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>2017-12-06</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>2017-12-05</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1999-01-26</th>
      <td>1999</td>
      <td>Cassius</td>
      <td>0</td>
      <td>Electronic</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>1999-01-26</th>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>1999-01-12</th>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>1999-01-12</th>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>1999-01-05</th>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 6 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dp4k</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="n">before</span><span class="o">=</span><span class="s">"2010-02-05"</span><span class="p">)</span>
<span class="n">dp4k</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="n">after</span><span class="o">=</span><span class="s">"2017-12-05"</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-12-06</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2017-12-06</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>2017-12-06</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>2017-12-06</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>2017-12-05</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>2017-12-05</th>
      <td>Perfect Angel</td>
      <td>Minnie Riperton</td>
      <td>1</td>
      <td>Pop/R&amp;B</td>
      <td>Best new reissue A deluxe reissue of Minnie Ri...</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2017-12-05</th>
      <td>Everyday Is Christmas</td>
      <td>Sia</td>
      <td>0</td>
      <td>Pop/R&amp;B</td>
      <td>Sias shiny Christmas album feels inconsistent...</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>2017-12-05</th>
      <td>Zaytown Sorority Class of 2017</td>
      <td>Zaytoven</td>
      <td>0</td>
      <td>Rap</td>
      <td>The prolific Atlanta producer enlists 17 women...</td>
      <td>6.2</td>
    </tr>
  </tbody>
</table>
</div>

<p>Timedeltas can be calculated from two date or datetime objects using arithmetic</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">timeA</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s">"2016-03-31 04:35:16 PM"</span><span class="p">)</span>
<span class="n">timeB</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s">"2016-03-20"</span><span class="p">)</span>

<span class="n">timeA</span> <span class="o">-</span> <span class="n">timeB</span>
<span class="n">timeB</span> <span class="o">-</span> <span class="n">timeA</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Timedelta('-12 days +07:24:44')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># creating an 'empty' 3 day timedelta
</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">hours</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">minutes</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span> <span class="c1"># 3 days + 2 hours + 2 minutes
</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s">"14 days 6 hours 12 minutes 49 seconds"</span><span class="p">)</span> <span class="c1"># can even be done with a string
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Timedelta('3 days 00:00:00')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">timeB</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Timestamp('2016-03-23 00:00:00')
</code></pre></div></div>

<p>An extension of this is the <strong>.dateoffset()</strong> method</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">pandas.tseries.offsets</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># adding two days
</span><span class="n">p4k</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># subtracting 2 weeks
</span><span class="n">p4k</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">weeks</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Adding a year
</span><span class="n">p4k</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># multiple
</span><span class="n">p4k</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">days</span><span class="o">=-</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1       2018-12-03
2       2018-12-03
3       2018-12-03
4       2018-12-03
5       2018-12-02
           ...    
19551   2000-01-23
19552   2000-01-23
19553   2000-01-09
19554   2000-01-09
19555   2000-01-02
Name: date, Length: 19555, dtype: datetime64[ns]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4k</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthEnd</span><span class="p">()</span> <span class="c1"># looks for next month end
</span><span class="n">p4k</span><span class="o">.</span><span class="n">date</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">MonthEnd</span><span class="p">()</span> <span class="c1"># looks for last month end
</span><span class="n">p4k</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">MonthBegin</span><span class="p">()</span> <span class="c1"># looks next beginning of month
</span><span class="n">p4k</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">BMonthEnd</span><span class="p">()</span> <span class="c1"># last business day of the month
</span><span class="n">p4k</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">QuarterEnd</span><span class="p">()</span> <span class="c1"># end of that quarter
</span><span class="n">p4k</span><span class="o">.</span><span class="n">date</span> <span class="o">+</span> <span class="n">YearEnd</span><span class="p">()</span> <span class="c1"># end of that year
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1       2017-12-31
2       2017-12-31
3       2017-12-31
4       2017-12-31
5       2017-12-31
           ...    
19551   1999-12-31
19552   1999-12-31
19553   1999-12-31
19554   1999-12-31
19555   1999-12-31
Name: date, Length: 19555, dtype: datetime64[ns]
</code></pre></div></div>

<h2 id="13-text-functions">13. Text Functions</h2>

<p><em>key attributes: .lower, .upper, .title, .len</em></p>

<p><em>key methods: .replace(), .contains(), .startswith(), .endswith(), .lstrip(), .rstrip(), .strip(), .title(), .split(), .get()</em></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">testString</span> <span class="o">=</span> <span class="s">"Education is what you get from reading the small print; experience is what you get from not reading it."</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">testString</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="c1"># all upper case
</span><span class="n">testString</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="c1"># all lower case
</span><span class="n">testString</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="c1"># all first characters capitalized
</span><span class="nb">len</span><span class="p">(</span><span class="n">testString</span><span class="p">)</span> <span class="c1"># number of characters
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>103
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">testString</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"reading"</span><span class="p">,</span><span class="s">"slowly reading"</span><span class="p">)</span> <span class="c1"># replacing strings
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'Education is what you get from slowly reading the small print; experience is what you get from not slowly reading it.'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">testBlankString</span> <span class="o">=</span> <span class="s">"   In the middle  "</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">testBlankString</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span> <span class="c1"># stripping blank text on the left
</span><span class="n">testBlankString</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="c1"># stripping blank text on the left
</span><span class="n">testBlankString</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="c1"># stripping blank text on bot ends
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'In the middle'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">testBlankString</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c1"># breaks string apart into individual words
# testBlankString.split(expand=True) #parameter 'expand' will return a df, not list
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['In', 'the', 'middle']
</code></pre></div></div>

<h2 id="14-merging-joining-and-concatenating">14. Merging, Joining, and Concatenating</h2>

<p><em>key methods: .concat(), .append(), .merge(), .join()</em></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># .concat() is used to row bind two datasets, assuming they have the same columns
</span>
<span class="n">p4k1</span> <span class="o">=</span> <span class="n">p4k</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="c1"># random sample of 12 rows
</span><span class="n">p4k2</span> <span class="o">=</span> <span class="n">p4k</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># random sample of 5 rows
</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">p4k1</span><span class="p">,</span><span class="n">p4k2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>River of Souls</td>
      <td>Magic Trick</td>
      <td>0</td>
      <td>2014-01-09</td>
      <td>None</td>
      <td>Tim Cohen wrote the songs for River of Souls w...</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>I Predict a Graceful Expulsion</td>
      <td>Cold Specks</td>
      <td>0</td>
      <td>2012-05-01</td>
      <td>None</td>
      <td>The 24-year old Canadian singer's transfixing ...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False Flag</td>
      <td>Rangda</td>
      <td>0</td>
      <td>2010-05-18</td>
      <td>Experimental</td>
      <td>This out-rock supergroup featuring Sir Richard...</td>
      <td>8.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Rare Grooves</td>
      <td>Various Artists</td>
      <td>0</td>
      <td>2005-03-17</td>
      <td>None</td>
      <td>Ireland's Bassbin label continues the improbab...</td>
      <td>8.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A Tribute to Brother Weldon</td>
      <td>Monk Hughes &amp; The Outer Realm</td>
      <td>0</td>
      <td>2004-07-29</td>
      <td>Jazz</td>
      <td>It's tough not to love a schizophrenic genius....</td>
      <td>5.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Temporary Pleasure</td>
      <td>Simian Mobile Disco</td>
      <td>0</td>
      <td>2009-09-03</td>
      <td>Electronic</td>
      <td>A grab bag of styles, SMD's latest features Ho...</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Lauschen</td>
      <td>Qluster</td>
      <td>0</td>
      <td>2013-02-15</td>
      <td>Electronic</td>
      <td>Hans-Joachim Roedelius (Zodiak Free Arts Lab, ...</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Hungry for Nothing</td>
      <td>Fight Amp</td>
      <td>0</td>
      <td>2008-03-20</td>
      <td>Metal</td>
      <td>This New Jersey band harkens back to a time wh...</td>
      <td>7.8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Chewed Corners</td>
      <td>µ-Ziq</td>
      <td>0</td>
      <td>2013-07-22</td>
      <td>Electronic</td>
      <td>Planet Mu's Mike Paradinas has never reached t...</td>
      <td>7.1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Backlash</td>
      <td>Black Joe Lewis &amp; the Honeybears</td>
      <td>0</td>
      <td>2017-02-07</td>
      <td>Rock</td>
      <td>Black Joe Lewis trawls the familiar intersecti...</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Life Ain't No Joke</td>
      <td>Lil Durk</td>
      <td>0</td>
      <td>2012-12-11</td>
      <td>Rap</td>
      <td>The Chicago teen and Chief Keef associate has ...</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Melo de Melo EP</td>
      <td>Ricardo Villalobos / Umho</td>
      <td>0</td>
      <td>2016-12-15</td>
      <td>Electronic</td>
      <td>On this two-track EP, Ricardo Villalobos teams...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Effigies of Evil</td>
      <td>Hooded Menace</td>
      <td>0</td>
      <td>2012-09-18</td>
      <td>None</td>
      <td>The Finnish doom metal group has always cited ...</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Ominosity</td>
      <td>Milemarker</td>
      <td>0</td>
      <td>2005-12-14</td>
      <td>Metal</td>
      <td>Fifth album from the shapeshifting post-hardco...</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Topsiders</td>
      <td>Aden</td>
      <td>0</td>
      <td>2002-08-29</td>
      <td>Rock</td>
      <td>Good news, punks! Thanks to your complete lack...</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Meds</td>
      <td>Placebo</td>
      <td>0</td>
      <td>2006-05-04</td>
      <td>Rock</td>
      <td>Latest record from the oddly successful glam- ...</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Field Report</td>
      <td>Field Report</td>
      <td>0</td>
      <td>2012-09-13</td>
      <td>None</td>
      <td>Chris Porterfield, the onetime bandmate of Jus...</td>
      <td>6.6</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">p4k1</span><span class="p">,</span><span class="n">p4k2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># setting to false maintains old index
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4741</th>
      <td>River of Souls</td>
      <td>Magic Trick</td>
      <td>0</td>
      <td>2014-01-09</td>
      <td>None</td>
      <td>Tim Cohen wrote the songs for River of Souls w...</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>6715</th>
      <td>I Predict a Graceful Expulsion</td>
      <td>Cold Specks</td>
      <td>0</td>
      <td>2012-05-01</td>
      <td>None</td>
      <td>The 24-year old Canadian singer's transfixing ...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>8985</th>
      <td>False Flag</td>
      <td>Rangda</td>
      <td>0</td>
      <td>2010-05-18</td>
      <td>Experimental</td>
      <td>This out-rock supergroup featuring Sir Richard...</td>
      <td>8.2</td>
    </tr>
    <tr>
      <th>15171</th>
      <td>Rare Grooves</td>
      <td>Various Artists</td>
      <td>0</td>
      <td>2005-03-17</td>
      <td>None</td>
      <td>Ireland's Bassbin label continues the improbab...</td>
      <td>8.2</td>
    </tr>
    <tr>
      <th>15885</th>
      <td>A Tribute to Brother Weldon</td>
      <td>Monk Hughes &amp; The Outer Realm</td>
      <td>0</td>
      <td>2004-07-29</td>
      <td>Jazz</td>
      <td>It's tough not to love a schizophrenic genius....</td>
      <td>5.5</td>
    </tr>
    <tr>
      <th>9808</th>
      <td>Temporary Pleasure</td>
      <td>Simian Mobile Disco</td>
      <td>0</td>
      <td>2009-09-03</td>
      <td>Electronic</td>
      <td>A grab bag of styles, SMD's latest features Ho...</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>5797</th>
      <td>Lauschen</td>
      <td>Qluster</td>
      <td>0</td>
      <td>2013-02-15</td>
      <td>Electronic</td>
      <td>Hans-Joachim Roedelius (Zodiak Free Arts Lab, ...</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>11543</th>
      <td>Hungry for Nothing</td>
      <td>Fight Amp</td>
      <td>0</td>
      <td>2008-03-20</td>
      <td>Metal</td>
      <td>This New Jersey band harkens back to a time wh...</td>
      <td>7.8</td>
    </tr>
    <tr>
      <th>5263</th>
      <td>Chewed Corners</td>
      <td>µ-Ziq</td>
      <td>0</td>
      <td>2013-07-22</td>
      <td>Electronic</td>
      <td>Planet Mu's Mike Paradinas has never reached t...</td>
      <td>7.1</td>
    </tr>
    <tr>
      <th>1075</th>
      <td>Backlash</td>
      <td>Black Joe Lewis &amp; the Honeybears</td>
      <td>0</td>
      <td>2017-02-07</td>
      <td>Rock</td>
      <td>Black Joe Lewis trawls the familiar intersecti...</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>5977</th>
      <td>Life Ain't No Joke</td>
      <td>Lil Durk</td>
      <td>0</td>
      <td>2012-12-11</td>
      <td>Rap</td>
      <td>The Chicago teen and Chief Keef associate has ...</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>1234</th>
      <td>Melo de Melo EP</td>
      <td>Ricardo Villalobos / Umho</td>
      <td>0</td>
      <td>2016-12-15</td>
      <td>Electronic</td>
      <td>On this two-track EP, Ricardo Villalobos teams...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>6265</th>
      <td>Effigies of Evil</td>
      <td>Hooded Menace</td>
      <td>0</td>
      <td>2012-09-18</td>
      <td>None</td>
      <td>The Finnish doom metal group has always cited ...</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>14232</th>
      <td>Ominosity</td>
      <td>Milemarker</td>
      <td>0</td>
      <td>2005-12-14</td>
      <td>Metal</td>
      <td>Fifth album from the shapeshifting post-hardco...</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>17861</th>
      <td>Topsiders</td>
      <td>Aden</td>
      <td>0</td>
      <td>2002-08-29</td>
      <td>Rock</td>
      <td>Good news, punks! Thanks to your complete lack...</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>13783</th>
      <td>Meds</td>
      <td>Placebo</td>
      <td>0</td>
      <td>2006-05-04</td>
      <td>Rock</td>
      <td>Latest record from the oddly successful glam- ...</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>6282</th>
      <td>Field Report</td>
      <td>Field Report</td>
      <td>0</td>
      <td>2012-09-13</td>
      <td>None</td>
      <td>Chris Porterfield, the onetime bandmate of Jus...</td>
      <td>6.6</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># append is very similar to concat
</span><span class="n">p4k1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p4k2</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>River of Souls</td>
      <td>Magic Trick</td>
      <td>0</td>
      <td>2014-01-09</td>
      <td>None</td>
      <td>Tim Cohen wrote the songs for River of Souls w...</td>
      <td>6.3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>I Predict a Graceful Expulsion</td>
      <td>Cold Specks</td>
      <td>0</td>
      <td>2012-05-01</td>
      <td>None</td>
      <td>The 24-year old Canadian singer's transfixing ...</td>
      <td>7.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False Flag</td>
      <td>Rangda</td>
      <td>0</td>
      <td>2010-05-18</td>
      <td>Experimental</td>
      <td>This out-rock supergroup featuring Sir Richard...</td>
      <td>8.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Rare Grooves</td>
      <td>Various Artists</td>
      <td>0</td>
      <td>2005-03-17</td>
      <td>None</td>
      <td>Ireland's Bassbin label continues the improbab...</td>
      <td>8.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A Tribute to Brother Weldon</td>
      <td>Monk Hughes &amp; The Outer Realm</td>
      <td>0</td>
      <td>2004-07-29</td>
      <td>Jazz</td>
      <td>It's tough not to love a schizophrenic genius....</td>
      <td>5.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Temporary Pleasure</td>
      <td>Simian Mobile Disco</td>
      <td>0</td>
      <td>2009-09-03</td>
      <td>Electronic</td>
      <td>A grab bag of styles, SMD's latest features Ho...</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Lauschen</td>
      <td>Qluster</td>
      <td>0</td>
      <td>2013-02-15</td>
      <td>Electronic</td>
      <td>Hans-Joachim Roedelius (Zodiak Free Arts Lab, ...</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Hungry for Nothing</td>
      <td>Fight Amp</td>
      <td>0</td>
      <td>2008-03-20</td>
      <td>Metal</td>
      <td>This New Jersey band harkens back to a time wh...</td>
      <td>7.8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Chewed Corners</td>
      <td>µ-Ziq</td>
      <td>0</td>
      <td>2013-07-22</td>
      <td>Electronic</td>
      <td>Planet Mu's Mike Paradinas has never reached t...</td>
      <td>7.1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Backlash</td>
      <td>Black Joe Lewis &amp; the Honeybears</td>
      <td>0</td>
      <td>2017-02-07</td>
      <td>Rock</td>
      <td>Black Joe Lewis trawls the familiar intersecti...</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Life Ain't No Joke</td>
      <td>Lil Durk</td>
      <td>0</td>
      <td>2012-12-11</td>
      <td>Rap</td>
      <td>The Chicago teen and Chief Keef associate has ...</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Melo de Melo EP</td>
      <td>Ricardo Villalobos / Umho</td>
      <td>0</td>
      <td>2016-12-15</td>
      <td>Electronic</td>
      <td>On this two-track EP, Ricardo Villalobos teams...</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Effigies of Evil</td>
      <td>Hooded Menace</td>
      <td>0</td>
      <td>2012-09-18</td>
      <td>None</td>
      <td>The Finnish doom metal group has always cited ...</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Ominosity</td>
      <td>Milemarker</td>
      <td>0</td>
      <td>2005-12-14</td>
      <td>Metal</td>
      <td>Fifth album from the shapeshifting post-hardco...</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Topsiders</td>
      <td>Aden</td>
      <td>0</td>
      <td>2002-08-29</td>
      <td>Rock</td>
      <td>Good news, punks! Thanks to your complete lack...</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Meds</td>
      <td>Placebo</td>
      <td>0</td>
      <td>2006-05-04</td>
      <td>Rock</td>
      <td>Latest record from the oddly successful glam- ...</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Field Report</td>
      <td>Field Report</td>
      <td>0</td>
      <td>2012-09-13</td>
      <td>None</td>
      <td>Chris Porterfield, the onetime bandmate of Jus...</td>
      <td>6.6</td>
    </tr>
  </tbody>
</table>
</div>

<p>Joining datasets togethers on the basis of their row values can be done with <strong>.merge()</strong> or <strong>.join()</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">'artist'</span><span class="p">:</span> <span class="p">[</span><span class="s">'Prince'</span><span class="p">,</span> <span class="s">'Kanye West'</span><span class="p">],</span> <span class="s">'DOB'</span><span class="p">:</span> <span class="p">[</span><span class="s">'June 7, 1958'</span><span class="p">,</span> <span class="s">'June 8, 1977'</span><span class="p">]}</span> <span class="c1"># test data
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>

<span class="c1"># Inner join example
</span><span class="n">p4k</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">"inner"</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">"artist"</span><span class="p">)</span>

<span class="c1"># p4k.merge(df, how="inner", on = "artist",suffixes=[" - p4k", " - df"]) # Example with identifying suffixes added
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>DOB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>One Nite Alone, The Aftershow: It Ain't Over!</td>
      <td>Prince</td>
      <td>1</td>
      <td>2016-09-01</td>
      <td>Pop/R&amp;B</td>
      <td>Best new reissue Originally released as part o...</td>
      <td>8.6</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sign "O" the Times</td>
      <td>Prince</td>
      <td>0</td>
      <td>2016-04-30</td>
      <td>Pop/R&amp;B</td>
      <td>Choosing a single high point from Prince's glo...</td>
      <td>10.0</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1999</td>
      <td>Prince</td>
      <td>0</td>
      <td>2016-04-30</td>
      <td>Pop/R&amp;B</td>
      <td>1999 is the greatest album ever made about par...</td>
      <td>10.0</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dirty Mind</td>
      <td>Prince</td>
      <td>0</td>
      <td>2016-04-29</td>
      <td>Pop/R&amp;B</td>
      <td>Princes first fully actualized album is an un...</td>
      <td>10.0</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Controversy</td>
      <td>Prince</td>
      <td>0</td>
      <td>2016-04-29</td>
      <td>Pop/R&amp;B</td>
      <td>Controversy emerged in 1981 at a pivotal time ...</td>
      <td>9.0</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>5</th>
      <td>HITNRUN Phase Two</td>
      <td>Prince</td>
      <td>0</td>
      <td>2016-01-08</td>
      <td>Pop/R&amp;B</td>
      <td>The second of Prince's HITNRUN series is anoth...</td>
      <td>4.7</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>6</th>
      <td>HITNRUN Phase One</td>
      <td>Prince</td>
      <td>0</td>
      <td>2015-09-10</td>
      <td>Pop/R&amp;B</td>
      <td>Prince's new effort, exclusive to Jay Z's Tida...</td>
      <td>4.5</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Planet Earth</td>
      <td>Prince</td>
      <td>0</td>
      <td>2007-07-23</td>
      <td>Pop/R&amp;B</td>
      <td>So far this year Prince has wowed at the Super...</td>
      <td>4.8</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Ultimate Prince</td>
      <td>Prince</td>
      <td>0</td>
      <td>2006-09-05</td>
      <td>Pop/R&amp;B</td>
      <td>This Prince best of covers the Warner Brothers...</td>
      <td>8.6</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3121</td>
      <td>Prince</td>
      <td>0</td>
      <td>2006-03-20</td>
      <td>Pop/R&amp;B</td>
      <td>On his latest release, the rock legend betters...</td>
      <td>6.0</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Musicology</td>
      <td>Prince</td>
      <td>0</td>
      <td>2004-04-28</td>
      <td>Pop/R&amp;B</td>
      <td>One of the first things a rock critic learns i...</td>
      <td>5.8</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>11</th>
      <td>The Life of Pablo</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2016-02-15</td>
      <td>Rap</td>
      <td>Best new music Finally, after a protracted and...</td>
      <td>9.0</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Yeezus</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2013-06-18</td>
      <td>Rap</td>
      <td>Best new music Marking a blunt break with the ...</td>
      <td>9.5</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>13</th>
      <td>My Beautiful Dark Twisted Fantasy</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2010-11-22</td>
      <td>Rap</td>
      <td>Best new music Kanye's big year culminates in ...</td>
      <td>10.0</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>14</th>
      <td>VH1 Storytellers</td>
      <td>Kanye West</td>
      <td>0</td>
      <td>2010-01-12</td>
      <td>Rap</td>
      <td>This live set finds Kanye inserting rambling m...</td>
      <td>4.9</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>15</th>
      <td>808s and Heartbreak</td>
      <td>Kanye West</td>
      <td>0</td>
      <td>2008-12-02</td>
      <td>Rap</td>
      <td>Poor Kanye West. The guy was already a ball of...</td>
      <td>7.6</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Graduation</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2007-09-11</td>
      <td>Rap</td>
      <td>Best new music Though it doesn't quite match C...</td>
      <td>8.7</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Late Registration</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2005-08-28</td>
      <td>Rap</td>
      <td>Best new music The producer-rapper follows his...</td>
      <td>9.5</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>18</th>
      <td>The College Dropout</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2004-02-20</td>
      <td>Rap</td>
      <td>Best new music College Dropout Mini-Course Syl...</td>
      <td>8.2</td>
      <td>June 8, 1977</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Outer join example - returns all rows found in either source
</span><span class="n">p4k</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">"outer"</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">"artist"</span><span class="p">)</span> <span class="c1"># in this case, same as left join
</span>
<span class="c1"># Right join example
</span><span class="n">p4k</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">"right"</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">"artist"</span><span class="p">)</span> <span class="c1"># in this case, same as inner
</span>
<span class="c1"># Left join example
</span><span class="n">p4k</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">"left"</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">"artist"</span><span class="p">)</span> <span class="c1"># leaves plenty of NaN's in DOB column
</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>DOB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19550</th>
      <td>1999</td>
      <td>Cassius</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>1999-01-05</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># If columns do not have the same names, use 'left_on' , 'right_on' parameters:
</span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s">"artist"</span> <span class="p">:</span> <span class="s">"artist_Name"</span><span class="p">,</span> <span class="s">"DOB"</span> <span class="p">:</span> <span class="s">"DOB"</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1">#  renaming of columns are done with a dictionary
</span><span class="n">df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>artist_Name</th>
      <th>DOB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kanye West</td>
      <td>June 8, 1977</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># make use of left_on and right_on arguments
</span><span class="n">p4k</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">"right"</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s">"artist"</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s">"artist_Name"</span><span class="p">)</span> <span class="c1"># leaves plenty of NaN's in DOB column
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>artist_Name</th>
      <th>DOB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>One Nite Alone, The Aftershow: It Ain't Over!</td>
      <td>Prince</td>
      <td>1</td>
      <td>2016-09-01</td>
      <td>Pop/R&amp;B</td>
      <td>Best new reissue Originally released as part o...</td>
      <td>8.6</td>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sign "O" the Times</td>
      <td>Prince</td>
      <td>0</td>
      <td>2016-04-30</td>
      <td>Pop/R&amp;B</td>
      <td>Choosing a single high point from Prince's glo...</td>
      <td>10.0</td>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1999</td>
      <td>Prince</td>
      <td>0</td>
      <td>2016-04-30</td>
      <td>Pop/R&amp;B</td>
      <td>1999 is the greatest album ever made about par...</td>
      <td>10.0</td>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dirty Mind</td>
      <td>Prince</td>
      <td>0</td>
      <td>2016-04-29</td>
      <td>Pop/R&amp;B</td>
      <td>Princes first fully actualized album is an un...</td>
      <td>10.0</td>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Controversy</td>
      <td>Prince</td>
      <td>0</td>
      <td>2016-04-29</td>
      <td>Pop/R&amp;B</td>
      <td>Controversy emerged in 1981 at a pivotal time ...</td>
      <td>9.0</td>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>5</th>
      <td>HITNRUN Phase Two</td>
      <td>Prince</td>
      <td>0</td>
      <td>2016-01-08</td>
      <td>Pop/R&amp;B</td>
      <td>The second of Prince's HITNRUN series is anoth...</td>
      <td>4.7</td>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>6</th>
      <td>HITNRUN Phase One</td>
      <td>Prince</td>
      <td>0</td>
      <td>2015-09-10</td>
      <td>Pop/R&amp;B</td>
      <td>Prince's new effort, exclusive to Jay Z's Tida...</td>
      <td>4.5</td>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Planet Earth</td>
      <td>Prince</td>
      <td>0</td>
      <td>2007-07-23</td>
      <td>Pop/R&amp;B</td>
      <td>So far this year Prince has wowed at the Super...</td>
      <td>4.8</td>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Ultimate Prince</td>
      <td>Prince</td>
      <td>0</td>
      <td>2006-09-05</td>
      <td>Pop/R&amp;B</td>
      <td>This Prince best of covers the Warner Brothers...</td>
      <td>8.6</td>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3121</td>
      <td>Prince</td>
      <td>0</td>
      <td>2006-03-20</td>
      <td>Pop/R&amp;B</td>
      <td>On his latest release, the rock legend betters...</td>
      <td>6.0</td>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Musicology</td>
      <td>Prince</td>
      <td>0</td>
      <td>2004-04-28</td>
      <td>Pop/R&amp;B</td>
      <td>One of the first things a rock critic learns i...</td>
      <td>5.8</td>
      <td>Prince</td>
      <td>June 7, 1958</td>
    </tr>
    <tr>
      <th>11</th>
      <td>The Life of Pablo</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2016-02-15</td>
      <td>Rap</td>
      <td>Best new music Finally, after a protracted and...</td>
      <td>9.0</td>
      <td>Kanye West</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Yeezus</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2013-06-18</td>
      <td>Rap</td>
      <td>Best new music Marking a blunt break with the ...</td>
      <td>9.5</td>
      <td>Kanye West</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>13</th>
      <td>My Beautiful Dark Twisted Fantasy</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2010-11-22</td>
      <td>Rap</td>
      <td>Best new music Kanye's big year culminates in ...</td>
      <td>10.0</td>
      <td>Kanye West</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>14</th>
      <td>VH1 Storytellers</td>
      <td>Kanye West</td>
      <td>0</td>
      <td>2010-01-12</td>
      <td>Rap</td>
      <td>This live set finds Kanye inserting rambling m...</td>
      <td>4.9</td>
      <td>Kanye West</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>15</th>
      <td>808s and Heartbreak</td>
      <td>Kanye West</td>
      <td>0</td>
      <td>2008-12-02</td>
      <td>Rap</td>
      <td>Poor Kanye West. The guy was already a ball of...</td>
      <td>7.6</td>
      <td>Kanye West</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Graduation</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2007-09-11</td>
      <td>Rap</td>
      <td>Best new music Though it doesn't quite match C...</td>
      <td>8.7</td>
      <td>Kanye West</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Late Registration</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2005-08-28</td>
      <td>Rap</td>
      <td>Best new music The producer-rapper follows his...</td>
      <td>9.5</td>
      <td>Kanye West</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>18</th>
      <td>The College Dropout</td>
      <td>Kanye West</td>
      <td>1</td>
      <td>2004-02-20</td>
      <td>Rap</td>
      <td>Best new music College Dropout Mini-Course Syl...</td>
      <td>8.2</td>
      <td>Kanye West</td>
      <td>June 8, 1977</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The .join() method requires a lot less code
</span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s">"artist"</span> <span class="p">:</span> <span class="s">"artist"</span><span class="p">,</span> <span class="s">"DOB"</span> <span class="p">:</span> <span class="s">"DOB"</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1">#  renaming of columns are done with a dictionary
</span><span class="n">p4k</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>album</th>
      <th>artist</th>
      <th>best</th>
      <th>date</th>
      <th>genre</th>
      <th>review</th>
      <th>score</th>
      <th>artist_Name</th>
      <th>DOB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A.M./Being There</td>
      <td>Wilco</td>
      <td>1</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>Best new reissue 1 / 2 Albums Newly reissued a...</td>
      <td>7.0</td>
      <td>Kanye West</td>
      <td>June 8, 1977</td>
    </tr>
    <tr>
      <th>2</th>
      <td>No Shame</td>
      <td>Hopsin</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rap</td>
      <td>On his corrosive fifth album, the rapper takes...</td>
      <td>3.5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Material Control</td>
      <td>Glassjaw</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Rock</td>
      <td>On their first album in 15 years, the Long Isl...</td>
      <td>6.6</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Weighing of the Heart</td>
      <td>Nabihah Iqbal</td>
      <td>0</td>
      <td>2017-12-06</td>
      <td>Pop/R&amp;B</td>
      <td>On her debut LP, British producer Nabihah Iqba...</td>
      <td>7.7</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>The Visitor</td>
      <td>Neil Young / Promise of the Real</td>
      <td>0</td>
      <td>2017-12-05</td>
      <td>Rock</td>
      <td>While still pointedly political, Neil Youngs ...</td>
      <td>6.7</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19551</th>
      <td>1999</td>
      <td>Cassius</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>Well, it's been two weeks now, and I guess it'...</td>
      <td>4.8</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19552</th>
      <td>Let Us Replay!</td>
      <td>Coldcut</td>
      <td>0</td>
      <td>1999-01-26</td>
      <td>Electronic</td>
      <td>The marketing guys of yer average modern megac...</td>
      <td>8.9</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19553</th>
      <td>Singles Breaking Up, Vol. 1</td>
      <td>Don Caballero</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Experimental</td>
      <td>Well, kids, I just went back and re-read my re...</td>
      <td>7.2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19554</th>
      <td>Out of Tune</td>
      <td>Mojave 3</td>
      <td>0</td>
      <td>1999-01-12</td>
      <td>Rock</td>
      <td>Out of Tune is a Steve Martin album. Yes, I'll...</td>
      <td>6.3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19555</th>
      <td>Left for Dead in Malaysia</td>
      <td>Neil Hamburger</td>
      <td>0</td>
      <td>1999-01-05</td>
      <td>None</td>
      <td>Neil Hamburger's third comedy release is a des...</td>
      <td>6.5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>19555 rows × 9 columns</p>
</div>

<h2 id="15-reshaping-dataframes">15. Reshaping dataframes</h2>
<p><em>key methods: .pivot(), .pivot_table(), .melt()</em></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># .pivot() returns a reshaped dataframe as a pivot table. Uses unique values from specified index and columns.
# does not support aggregation
</span>
<span class="n">p4ksubset</span> <span class="o">=</span> <span class="n">p4k</span><span class="p">[</span><span class="n">p4k</span><span class="p">[</span><span class="s">'artist'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s">"Kanye West"</span><span class="p">,</span><span class="s">"Nas"</span><span class="p">,</span><span class="s">"Coldplay"</span><span class="p">])]</span>
<span class="n">p4ksubset</span> <span class="o">=</span> <span class="n">p4ksubset</span><span class="p">[[</span><span class="s">'artist'</span><span class="p">,</span><span class="s">'album'</span><span class="p">,</span><span class="s">'best'</span><span class="p">,</span><span class="s">'score'</span><span class="p">]]</span>
<span class="n">p4ksubset</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>artist</th>
      <th>album</th>
      <th>best</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>501</th>
      <td>Coldplay</td>
      <td>Kaleidoscope</td>
      <td>0</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>2315</th>
      <td>Kanye West</td>
      <td>The Life of Pablo</td>
      <td>1</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2493</th>
      <td>Coldplay</td>
      <td>A Head Full of Dreams</td>
      <td>0</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>4279</th>
      <td>Coldplay</td>
      <td>Ghost Stories</td>
      <td>0</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>5369</th>
      <td>Kanye West</td>
      <td>Yeezus</td>
      <td>1</td>
      <td>9.5</td>
    </tr>
    <tr>
      <th>5884</th>
      <td>Nas</td>
      <td>Illmatic</td>
      <td>1</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>6458</th>
      <td>Nas</td>
      <td>Life Is Good</td>
      <td>1</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>7297</th>
      <td>Coldplay</td>
      <td>Mylo Xyloto</td>
      <td>0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>8370</th>
      <td>Kanye West</td>
      <td>My Beautiful Dark Twisted Fantasy</td>
      <td>1</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>9436</th>
      <td>Kanye West</td>
      <td>VH1 Storytellers</td>
      <td>0</td>
      <td>4.9</td>
    </tr>
    <tr>
      <th>10120</th>
      <td>Coldplay</td>
      <td>LeftRightLeftRightLeft</td>
      <td>0</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>10670</th>
      <td>Kanye West</td>
      <td>808s and Heartbreak</td>
      <td>0</td>
      <td>7.6</td>
    </tr>
    <tr>
      <th>10685</th>
      <td>Coldplay</td>
      <td>Prospekts March EP</td>
      <td>0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>11140</th>
      <td>Nas</td>
      <td>Untitled</td>
      <td>0</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>11240</th>
      <td>Coldplay</td>
      <td>Viva la Vida or Death and All His Friends</td>
      <td>0</td>
      <td>6.9</td>
    </tr>
    <tr>
      <th>11939</th>
      <td>Nas</td>
      <td>Greatest Hits</td>
      <td>0</td>
      <td>6.4</td>
    </tr>
    <tr>
      <th>12158</th>
      <td>Kanye West</td>
      <td>Graduation</td>
      <td>1</td>
      <td>8.7</td>
    </tr>
    <tr>
      <th>13045</th>
      <td>Nas</td>
      <td>Hip Hop Is Dead</td>
      <td>0</td>
      <td>7.8</td>
    </tr>
    <tr>
      <th>14610</th>
      <td>Kanye West</td>
      <td>Late Registration</td>
      <td>1</td>
      <td>9.5</td>
    </tr>
    <tr>
      <th>14893</th>
      <td>Coldplay</td>
      <td>X&amp;Y</td>
      <td>0</td>
      <td>4.9</td>
    </tr>
    <tr>
      <th>15460</th>
      <td>Nas</td>
      <td>Street's Disciple</td>
      <td>0</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>16370</th>
      <td>Kanye West</td>
      <td>The College Dropout</td>
      <td>1</td>
      <td>8.2</td>
    </tr>
    <tr>
      <th>16535</th>
      <td>Coldplay</td>
      <td>Live 2003</td>
      <td>0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>17568</th>
      <td>Nas</td>
      <td>God's Son</td>
      <td>0</td>
      <td>8.6</td>
    </tr>
    <tr>
      <th>17765</th>
      <td>Nas</td>
      <td>The Lost Tapes</td>
      <td>0</td>
      <td>6.9</td>
    </tr>
    <tr>
      <th>17839</th>
      <td>Coldplay</td>
      <td>A Rush of Blood to the Head</td>
      <td>0</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>19027</th>
      <td>Coldplay</td>
      <td>Parachutes</td>
      <td>0</td>
      <td>5.3</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4ksubset</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'album'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'artist'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'best'</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>artist</th>
      <th>Coldplay</th>
      <th>Kanye West</th>
      <th>Nas</th>
    </tr>
    <tr>
      <th>album</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>808s and Heartbreak</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>A Head Full of Dreams</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>A Rush of Blood to the Head</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ghost Stories</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>God's Son</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Graduation</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Greatest Hits</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Hip Hop Is Dead</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Illmatic</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Kaleidoscope</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Late Registration</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>LeftRightLeftRightLeft</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Life Is Good</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Live 2003</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>My Beautiful Dark Twisted Fantasy</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mylo Xyloto</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Parachutes</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Prospekts March EP</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Street's Disciple</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>The College Dropout</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>The Life of Pablo</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>The Lost Tapes</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Untitled</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>VH1 Storytellers</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Viva la Vida or Death and All His Friends</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>X&amp;Y</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Yeezus</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># .pivot_table() - parameters values, index, columns, and agg (aggregate function)
</span><span class="n">p4ksubset</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s">'score'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s">'artist'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">)</span>

<span class="c1"># other aggfunc arguments include count, sum, min, max
</span></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score</th>
    </tr>
    <tr>
      <th>artist</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Coldplay</th>
      <td>5.727273</td>
    </tr>
    <tr>
      <th>Kanye West</th>
      <td>8.425000</td>
    </tr>
    <tr>
      <th>Nas</th>
      <td>7.375000</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># pivot table with multiple indexes
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p4ksubset</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s">'score'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'artist'</span><span class="p">,</span><span class="s">'best'</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>score</th>
    </tr>
    <tr>
      <th>artist</th>
      <th>best</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Coldplay</th>
      <th>0</th>
      <td>5.727273</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Kanye West</th>
      <th>0</th>
      <td>6.250000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.150000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Nas</th>
      <th>0</th>
      <td>6.783333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.150000</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## .melt is essentially the inverse of pivot_table. Converting to a more tabular version
</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>score</th>
    </tr>
    <tr>
      <th>artist</th>
      <th>best</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Coldplay</th>
      <th>0</th>
      <td>5.727273</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Kanye West</th>
      <th>0</th>
      <td>6.250000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.150000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Nas</th>
      <th>0</th>
      <td>6.783333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.150000</td>
    </tr>
  </tbody>
</table>
</div>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#pandas" class="page__taxonomy-item" rel="tag">pandas</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#python" class="page__taxonomy-item" rel="tag">python</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#reference" class="page__taxonomy-item" rel="tag">reference</a>
    
    </span>
  </p>


      </footer>

      

    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 Ravi Solter. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>











  </body>
</html>
